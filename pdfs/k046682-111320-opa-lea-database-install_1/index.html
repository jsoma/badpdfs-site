<!DOCTYPE html><html lang="en" data-astro-cid-wxiprx5h> <head><meta charset="utf-8"><link rel="icon" type="image/svg+xml" href="/favicon.svg"><meta name="viewport" content="width=device-width"><meta name="generator" content="Astro v5.12.6"><title>Complex Extraction of Law Enforcement Complaints - bad pdfs</title><link rel="stylesheet" href="/_astro/about.K2Del1EQ.css">
<link rel="stylesheet" href="/_astro/about.DqOHNfsy.css">
<style>code[class*=language-],pre[class*=language-]{color:#ccc;background:none;font-family:Consolas,Monaco,Andale Mono,Ubuntu Mono,monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none}pre[class*=language-]{padding:1em;margin:.5em 0;overflow:auto}:not(pre)>code[class*=language-],pre[class*=language-]{background:#2d2d2d}:not(pre)>code[class*=language-]{padding:.1em;border-radius:.3em;white-space:normal}.token.comment,.token.block-comment,.token.prolog,.token.doctype,.token.cdata{color:#999}.token.punctuation{color:#ccc}.token.tag,.token.attr-name,.token.namespace,.token.deleted{color:#e2777a}.token.function-name{color:#6196cc}.token.boolean,.token.number,.token.function{color:#f08d49}.token.property,.token.class-name,.token.constant,.token.symbol{color:#f8c555}.token.selector,.token.important,.token.atrule,.token.keyword,.token.builtin{color:#cc99cd}.token.string,.token.char,.token.attr-value,.token.regex,.token.variable{color:#7ec699}.token.operator,.token.entity,.token.url{color:#67cdcc}.token.important,.token.bold{font-weight:700}.token.italic{font-style:italic}.token.entity{cursor:help}.token.inserted{color:green}
</style>
<link rel="stylesheet" href="/_astro/_slug_.B3jYt87b.css"></head> <body data-astro-cid-wxiprx5h> <header class="site-header" data-astro-cid-3ef6ksr2> <div class="header-container" data-astro-cid-3ef6ksr2> <div class="header-left" data-astro-cid-3ef6ksr2> <a href="/" class="site-title" data-astro-cid-3ef6ksr2> <h1 data-astro-cid-3ef6ksr2>bad pdfs</h1> </a> <nav class="header-nav" data-astro-cid-3ef6ksr2> <a href="/" class data-astro-cid-3ef6ksr2>Gallery</a> <a href="/methods/" class data-astro-cid-3ef6ksr2>All Methods</a> <a href="/about/" class data-astro-cid-3ef6ksr2>About</a> <a href="https://jsoma.github.io/natural-pdf/" target="_blank" rel="noopener noreferrer" class="external" data-astro-cid-3ef6ksr2>
natural-pdf docs
<svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" data-astro-cid-3ef6ksr2> <path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6" data-astro-cid-3ef6ksr2></path> <polyline points="15 3 21 3 21 9" data-astro-cid-3ef6ksr2></polyline> <line x1="10" y1="14" x2="21" y2="3" data-astro-cid-3ef6ksr2></line> </svg> </a> </nav> </div> <div class="header-right" data-astro-cid-3ef6ksr2> <button class="dark-mode-toggle" aria-label="Toggle dark mode" data-astro-cid-tcsrer47> <svg class="sun-icon" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" data-astro-cid-tcsrer47> <circle cx="12" cy="12" r="5" data-astro-cid-tcsrer47></circle> <line x1="12" y1="1" x2="12" y2="3" data-astro-cid-tcsrer47></line> <line x1="12" y1="21" x2="12" y2="23" data-astro-cid-tcsrer47></line> <line x1="4.22" y1="4.22" x2="5.64" y2="5.64" data-astro-cid-tcsrer47></line> <line x1="18.36" y1="18.36" x2="19.78" y2="19.78" data-astro-cid-tcsrer47></line> <line x1="1" y1="12" x2="3" y2="12" data-astro-cid-tcsrer47></line> <line x1="21" y1="12" x2="23" y2="12" data-astro-cid-tcsrer47></line> <line x1="4.22" y1="19.78" x2="5.64" y2="18.36" data-astro-cid-tcsrer47></line> <line x1="18.36" y1="5.64" x2="19.78" y2="4.22" data-astro-cid-tcsrer47></line> </svg> <svg class="moon-icon" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" data-astro-cid-tcsrer47> <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z" data-astro-cid-tcsrer47></path> </svg> </button>  <script type="module">const m=document.querySelector(".dark-mode-toggle"),e=document.documentElement,r=localStorage.getItem("theme")||"light";e.setAttribute("data-theme",r);m?.addEventListener("click",()=>{const t=e.getAttribute("data-theme")==="dark"?"light":"dark";e.setAttribute("data-theme",t),localStorage.setItem("theme",t)});const a=window.matchMedia("(prefers-color-scheme: dark)");localStorage.getItem("theme")||e.setAttribute("data-theme",a.matches?"dark":"light");a.addEventListener("change",t=>{localStorage.getItem("theme")||e.setAttribute("data-theme",t.matches?"dark":"light")});</script> <!-- Pass BASE_URL to client-side JavaScript --><meta name="base-url" content="/" style="display: none;"><div class="search-wrapper" data-astro-cid-otpdt6jm> <div class="search-container" data-astro-cid-otpdt6jm> <div class="search-input-wrapper" data-astro-cid-otpdt6jm> <svg class="search-icon" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" data-astro-cid-otpdt6jm> <circle cx="11" cy="11" r="8" data-astro-cid-otpdt6jm></circle> <path d="m21 21-4.35-4.35" data-astro-cid-otpdt6jm></path> </svg> <input type="search" id="search-input" class="search-input" placeholder="Search PDFs, methods, or content..." autocomplete="off" spellcheck="false" data-astro-cid-otpdt6jm> <span class="search-shortcut" data-astro-cid-otpdt6jm>/</span> </div> <div id="search-results" class="search-results" data-astro-cid-otpdt6jm></div> </div> </div> <script type="module" src="/_astro/Search.astro_astro_type_script_index_0_lang.Bxe8LC99.js"></script>  <!-- Global styles for dynamically generated search results -->  </div> </div> </header>  <div class="container mx-auto px-4 py-8 max-w-7xl" data-astro-cid-wxiprx5h> <!-- PDF Preview and Info Header --> <header class="mb-8 border-b" data-astro-cid-wxiprx5h> <div class="md:grid md:grid-cols-3 gap-6 p-6" data-astro-cid-wxiprx5h> <!-- PDF Preview --> <div class="md:col-span-1 mb-6 md:mb-0 header-preview" data-astro-cid-wxiprx5h> <img src="/artifacts/screenshots/k046682-111320-opa-lea-database-install_1/k046682-111320-opa-lea-database-install_1-1.png" alt="Complex Extraction of Law Enforcement Complaints preview" class="w-full" data-astro-cid-wxiprx5h> <p class="text-sm text-gray-500 mt-2 text-center" data-astro-cid-wxiprx5h>k046682-111320-opa-lea-database-install_1.pdf</p> </div> <!-- Title and Description --> <div class="md:col-span-2" data-astro-cid-wxiprx5h> <h1 class="text-4xl font-bold mb-3" data-astro-cid-wxiprx5h>Complex Extraction of Law Enforcement Complaints</h1> <p class="text-lg mb-4" data-astro-cid-wxiprx5h>This PDF contains a set of complaint records from a local law enforcement agency. Challenges include its relational data structure, unusual formatting common in the region, and redactions that disrupt automatic parsing.</p> <!-- Methods --> <div class="mb-4" data-astro-cid-wxiprx5h> <h3 class="text-sm font-semibold text-gray-500 uppercase tracking-wider mb-2" data-astro-cid-wxiprx5h>Methods Used</h3> <div class="flex flex-wrap gap-2" data-astro-cid-wxiprx5h> <a href="/methods/guides" class="method-tag" data-astro-cid-wxiprx5h> Guides </a><a href="/methods/pdf" class="method-tag" data-astro-cid-wxiprx5h> PDF </a><a href="/methods/above" class="method-tag" data-astro-cid-wxiprx5h> above </a><a href="/methods/add_exclusion" class="method-tag" data-astro-cid-wxiprx5h> add_exclusion </a><a href="/methods/below" class="method-tag" data-astro-cid-wxiprx5h> below </a><a href="/methods/expand" class="method-tag" data-astro-cid-wxiprx5h> expand </a><a href="/methods/extract_table" class="method-tag" data-astro-cid-wxiprx5h> extract_table </a><a href="/methods/extract_text" class="method-tag" data-astro-cid-wxiprx5h> extract_text </a><a href="/methods/find" class="method-tag" data-astro-cid-wxiprx5h> find </a><a href="/methods/find_all" class="method-tag" data-astro-cid-wxiprx5h> find_all </a><a href="/methods/from_lines" class="method-tag" data-astro-cid-wxiprx5h> from_lines </a><a href="/methods/get_sections" class="method-tag" data-astro-cid-wxiprx5h> get_sections </a><a href="/methods/merge" class="method-tag" data-astro-cid-wxiprx5h> merge </a><a href="/methods/right" class="method-tag" data-astro-cid-wxiprx5h> right </a><a href="/methods/show" class="method-tag" data-astro-cid-wxiprx5h> show </a><a href="/methods/to_df" class="method-tag" data-astro-cid-wxiprx5h> to_df </a> </div> </div> <!-- Tags --> <div class="mb-4" data-astro-cid-wxiprx5h> <h3 class="text-sm font-semibold text-gray-500 uppercase tracking-wider mb-2" data-astro-cid-wxiprx5h>Tags</h3> <div class="flex flex-wrap gap-2" data-astro-cid-wxiprx5h> <span class="tag-tag" data-astro-cid-wxiprx5h>
#law enforcement </span><span class="tag-tag" data-astro-cid-wxiprx5h>
#PDF extraction </span><span class="tag-tag" data-astro-cid-wxiprx5h>
#redactions </span><span class="tag-tag" data-astro-cid-wxiprx5h>
#relational data </span><span class="tag-tag" data-astro-cid-wxiprx5h>
#complex formatting </span> </div> </div> <!-- Colab Link --> <div class="mb-4" data-astro-cid-wxiprx5h> <h3 class="text-sm font-semibold text-gray-500 uppercase tracking-wider mb-2" data-astro-cid-wxiprx5h>The code</h3> <div class="flex flex-wrap gap-2" data-astro-cid-wxiprx5h> <a href="https://colab.research.google.com/github/jsoma/badpdfs-site/blob/gh-pages/artifacts/pdfs/k046682-111320-opa-lea-database-install_1/notebooks/k046682-111320-opa-lea-database-install_1.ipynb" target="_blank" rel="noopener noreferrer" class="inline-block colab-btn" title="Open in Google Colab" data-astro-cid-wxiprx5h> <img src="/colab-badge.svg" alt="Open in Colab" data-astro-cid-wxiprx5h> </a> <a href="https://github.com/jsoma/badpdfs-site/blob/gh-pages/artifacts/pdfs/k046682-111320-opa-lea-database-install_1/notebooks/k046682-111320-opa-lea-database-install_1.ipynb" target="_blank" rel="noopener noreferrer" class="inline-block gh-btn" title="Open in GitHub" data-astro-cid-wxiprx5h> <img src="/gh-badge.svg" alt="Read notebook" data-astro-cid-wxiprx5h> </a> </div> </div> <!-- Other walkthroughs using this PDF -->  </div> </div> </header> <!-- Main Content Area with Optional PDF Preview --> <div class="content-wrapper" data-astro-cid-wxiprx5h> <!-- PDF Button/Sidebar --> <aside class="pdf-sidebar" data-astro-cid-wxiprx5h> <button class="pdf-view-btn" data-astro-cid-wxiprx5h>
ðŸ“– View PDF
</button> <div class="pdf-sidebar-content" style="display: none;" data-astro-cid-wxiprx5h> <button class="pdf-close-btn" data-astro-cid-wxiprx5h> <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" data-astro-cid-wxiprx5h> <line x1="18" y1="6" x2="6" y2="18" data-astro-cid-wxiprx5h></line> <line x1="6" y1="6" x2="18" y2="18" data-astro-cid-wxiprx5h></line> </svg> </button> <div class="pdf-preview-wrapper" data-astro-cid-wxiprx5h> <iframe class="pdf-embed" type="application/pdf" data-pdf-url="https://pub-4e99d31d19cb404d8d4f5f7efa51ef6e.r2.dev/pdfs/k046682-111320-opa-lea-database-install_1/k046682-111320-opa-lea-database-install_1.pdf" data-astro-cid-wxiprx5h></iframe> </div> <p class="text-sm text-gray-500 mt-2 text-center" data-astro-cid-wxiprx5h>k046682-111320-opa-lea-database-install_1.pdf</p> </div> </aside> <!-- Code and Output --> <div class="main-content" data-astro-cid-wxiprx5h> <div class="cells-container space-y-8" data-astro-cid-wxiprx5h> <div class="cell-container markdown-cell" data-astro-cid-wxiprx5h> <div class="prose prose-lg max-w-none prose-headings:text-gray-900 prose-h1:text-3xl prose-h2:text-2xl prose-h3:text-xl" data-astro-cid-wxiprx5h><h1>Complex Extraction of Law Enforcement Complaints</h1>
<p>This PDF contains a set of complaint records from a local law enforcement agency. Challenges include its relational data structure, unusual formatting common in the region, and redactions that disrupt automatic parsing.</p>
</div> </div><div id="code-0" class="cell-container " data-astro-cid-wxiprx5h> <div class="code-output-container space-y-1" data-astro-cid-wxiprx5h> <!-- Code Block --> <div class="code-section" data-astro-cid-wxiprx5h> <div class="bg-gray-900 text-gray-100 p-4 relative" data-astro-cid-wxiprx5h> <button class="copy-btn absolute top-2 right-2 px-2 py-1 text-xs bg-gray-800 hover:bg-gray-700 text-gray-300 hover:text-white rounded transition-colors cursor-pointer flex items-center gap-1" onclick="copyCode(this)" data-code="from natural_pdf import PDF

pdf = PDF(&#34;k046682-111320-opa-lea-database-install_1.pdf&#34;)
pdf.show(cols=3)" data-astro-cid-wxiprx5h> <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" data-astro-cid-wxiprx5h> <rect x="9" y="9" width="13" height="13" rx="2" ry="2" data-astro-cid-wxiprx5h></rect> <path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1" data-astro-cid-wxiprx5h></path> </svg> <span data-astro-cid-wxiprx5h>Copy</span> </button>   <pre class="text-base overflow-x-auto" data-astro-cid-wxiprx5h><code class="language-{cell.type === 'bash' ? 'bash' : 'python'}" data-astro-cid-wxiprx5h><span class="token keyword">from</span> natural_pdf <span class="token keyword">import</span> PDF

pdf <span class="token operator">=</span> PDF<span class="token punctuation">(</span><span class="token string">"k046682-111320-opa-lea-database-install_1.pdf"</span><span class="token punctuation">)</span>
pdf<span class="token punctuation">.</span>show<span class="token punctuation">(</span>cols<span class="token operator">=</span><span class="token number">3</span><span class="token punctuation">)</span></code></pre> </div> </div> <!-- Output --> <div class="output-section" data-astro-cid-wxiprx5h> <div class="bg-gray-50" data-astro-cid-wxiprx5h> <div class="p-4 font-mono text-base" data-astro-cid-wxiprx5h> <div class="text-xs text-gray-500 mb-2 uppercase tracking-wider" data-astro-cid-wxiprx5h>Output</div> <pre class="whitespace-pre-wrap text-gray-700" data-astro-cid-wxiprx5h>[DEBUG] Executing code: from natural_pdf import PDF
pdf = PDF(&#39;k046682-111320-opa-lea-database-install_1.pdf&#39;)...
[DEBUG] Evaluating expression: pdf.show(cols=3)...
</pre> </div> <div class="p-4" data-astro-cid-wxiprx5h> <a href="/artifacts/executions/pdfs/k046682-111320-opa-lea-database-install_1/k046682-111320-opa-lea-database-install_1/images/image_1.png" class="result-image" data-astro-cid-wxiprx5h> <img src="/artifacts/executions/pdfs/k046682-111320-opa-lea-database-install_1/k046682-111320-opa-lea-database-install_1/images/image_1.png" alt="Result" class="max-w-full cursor-zoom-in" data-astro-cid-wxiprx5h> </a>   </div>   </div> </div> </div> </div><div class="cell-container markdown-cell" data-astro-cid-wxiprx5h> <div class="prose prose-lg max-w-none prose-headings:text-gray-900 prose-h1:text-3xl prose-h2:text-2xl prose-h3:text-xl" data-astro-cid-wxiprx5h><p>Let&#39;s look at a single page</p>
</div> </div><div id="code-1" class="cell-container " data-astro-cid-wxiprx5h> <div class="code-output-container space-y-1" data-astro-cid-wxiprx5h> <!-- Code Block --> <div class="code-section" data-astro-cid-wxiprx5h> <div class="bg-gray-900 text-gray-100 p-4 relative" data-astro-cid-wxiprx5h> <button class="copy-btn absolute top-2 right-2 px-2 py-1 text-xs bg-gray-800 hover:bg-gray-700 text-gray-300 hover:text-white rounded transition-colors cursor-pointer flex items-center gap-1" onclick="copyCode(this)" data-code="page = pdf.pages[0]
page.show()" data-astro-cid-wxiprx5h> <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" data-astro-cid-wxiprx5h> <rect x="9" y="9" width="13" height="13" rx="2" ry="2" data-astro-cid-wxiprx5h></rect> <path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1" data-astro-cid-wxiprx5h></path> </svg> <span data-astro-cid-wxiprx5h>Copy</span> </button>   <pre class="text-base overflow-x-auto" data-astro-cid-wxiprx5h><code class="language-{cell.type === 'bash' ? 'bash' : 'python'}" data-astro-cid-wxiprx5h>page <span class="token operator">=</span> pdf<span class="token punctuation">.</span>pages<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
page<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre> </div> </div> <!-- Output --> <div class="output-section" data-astro-cid-wxiprx5h> <div class="bg-gray-50" data-astro-cid-wxiprx5h> <div class="p-4 font-mono text-base" data-astro-cid-wxiprx5h> <div class="text-xs text-gray-500 mb-2 uppercase tracking-wider" data-astro-cid-wxiprx5h>Output</div> <pre class="whitespace-pre-wrap text-gray-700" data-astro-cid-wxiprx5h>[DEBUG] Executing code: page = pdf.pages[0]...
[DEBUG] Evaluating expression: page.show()...
</pre> </div> <div class="p-4" data-astro-cid-wxiprx5h> <a href="/artifacts/executions/pdfs/k046682-111320-opa-lea-database-install_1/k046682-111320-opa-lea-database-install_1/images/image_2.png" class="result-image" data-astro-cid-wxiprx5h> <img src="/artifacts/executions/pdfs/k046682-111320-opa-lea-database-install_1/k046682-111320-opa-lea-database-install_1/images/image_2.png" alt="Result" class="max-w-full cursor-zoom-in" data-astro-cid-wxiprx5h> </a>   </div>   </div> </div> </div> </div><div class="cell-container markdown-cell" data-astro-cid-wxiprx5h> <div class="prose prose-lg max-w-none prose-headings:text-gray-900 prose-h1:text-3xl prose-h2:text-2xl prose-h3:text-xl" data-astro-cid-wxiprx5h><h2>Adding exclusions</h2>
<p>We don&#39;t like the top and bottom areas, so we&#39;ll exclude them.</p>
</div> </div><div id="code-2" class="cell-container " data-astro-cid-wxiprx5h> <div class="code-output-container space-y-1" data-astro-cid-wxiprx5h> <!-- Code Block --> <div class="code-section" data-astro-cid-wxiprx5h> <div class="bg-gray-900 text-gray-100 p-4 relative" data-astro-cid-wxiprx5h> <button class="copy-btn absolute top-2 right-2 px-2 py-1 text-xs bg-gray-800 hover:bg-gray-700 text-gray-300 hover:text-white rounded transition-colors cursor-pointer flex items-center gap-1" onclick="copyCode(this)" data-code="pdf.add_exclusion(lambda page: page.find(text='L.E.A. Data Technologies').below(include_source=True))
pdf.add_exclusion(lambda page: page.find(text='Complaints By Date').above(include_source=True))

page.show(exclusions='black')" data-astro-cid-wxiprx5h> <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" data-astro-cid-wxiprx5h> <rect x="9" y="9" width="13" height="13" rx="2" ry="2" data-astro-cid-wxiprx5h></rect> <path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1" data-astro-cid-wxiprx5h></path> </svg> <span data-astro-cid-wxiprx5h>Copy</span> </button>   <pre class="text-base overflow-x-auto" data-astro-cid-wxiprx5h><code class="language-{cell.type === 'bash' ? 'bash' : 'python'}" data-astro-cid-wxiprx5h>pdf<span class="token punctuation">.</span>add_exclusion<span class="token punctuation">(</span><span class="token keyword">lambda</span> page<span class="token punctuation">:</span> page<span class="token punctuation">.</span>find<span class="token punctuation">(</span>text<span class="token operator">=</span><span class="token string">'L.E.A. Data Technologies'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>below<span class="token punctuation">(</span>include_source<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
pdf<span class="token punctuation">.</span>add_exclusion<span class="token punctuation">(</span><span class="token keyword">lambda</span> page<span class="token punctuation">:</span> page<span class="token punctuation">.</span>find<span class="token punctuation">(</span>text<span class="token operator">=</span><span class="token string">'Complaints By Date'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>above<span class="token punctuation">(</span>include_source<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

page<span class="token punctuation">.</span>show<span class="token punctuation">(</span>exclusions<span class="token operator">=</span><span class="token string">'black'</span><span class="token punctuation">)</span></code></pre> </div> </div> <!-- Output --> <div class="output-section" data-astro-cid-wxiprx5h> <div class="bg-gray-50" data-astro-cid-wxiprx5h> <div class="p-4 font-mono text-base" data-astro-cid-wxiprx5h> <div class="text-xs text-gray-500 mb-2 uppercase tracking-wider" data-astro-cid-wxiprx5h>Output</div> <pre class="whitespace-pre-wrap text-gray-700" data-astro-cid-wxiprx5h>[DEBUG] Executing code: pdf.add_exclusion(lambda page: page.find(text=&#39;L.E.A. Data Technologies&#39;).below(include_source=True)...
[DEBUG] Evaluating expression: page.show(exclusions=&#39;black&#39;)...
</pre> </div> <div class="p-4" data-astro-cid-wxiprx5h> <a href="/artifacts/executions/pdfs/k046682-111320-opa-lea-database-install_1/k046682-111320-opa-lea-database-install_1/images/image_3.png" class="result-image" data-astro-cid-wxiprx5h> <img src="/artifacts/executions/pdfs/k046682-111320-opa-lea-database-install_1/k046682-111320-opa-lea-database-install_1/images/image_3.png" alt="Result" class="max-w-full cursor-zoom-in" data-astro-cid-wxiprx5h> </a>   </div>   </div> </div> </div> </div><div class="cell-container markdown-cell" data-astro-cid-wxiprx5h> <div class="prose prose-lg max-w-none prose-headings:text-gray-900 prose-h1:text-3xl prose-h2:text-2xl prose-h3:text-xl" data-astro-cid-wxiprx5h><h2>Breaking into sections</h2>
<p>Even though you might think the colors are the best route to tackle this â€“ they stand out! â€“ I think text is usually the best option.</p>
<p>We&#39;ll tell it to break the pages into sections by the <strong>Recorded On Camera</strong> text. We tell it <code>include_boundaries=&#39;start&#39;</code>.</p>
<blockquote>
<p>Originally I did this with <strong>Location of Occurrence</strong> but apparently it&#39;s a <em>little bit lower</em> than the recording header and caused some problems later on.</p>
</blockquote>
</div> </div><div id="code-3" class="cell-container " data-astro-cid-wxiprx5h> <div class="code-output-container space-y-1" data-astro-cid-wxiprx5h> <!-- Code Block --> <div class="code-section" data-astro-cid-wxiprx5h> <div class="bg-gray-900 text-gray-100 p-4 relative" data-astro-cid-wxiprx5h> <button class="copy-btn absolute top-2 right-2 px-2 py-1 text-xs bg-gray-800 hover:bg-gray-700 text-gray-300 hover:text-white rounded transition-colors cursor-pointer flex items-center gap-1" onclick="copyCode(this)" data-code="sections = pdf.get_sections(
  'text:contains(Recorded)',
  include_boundaries='start'
)
sections.show(cols=3)" data-astro-cid-wxiprx5h> <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" data-astro-cid-wxiprx5h> <rect x="9" y="9" width="13" height="13" rx="2" ry="2" data-astro-cid-wxiprx5h></rect> <path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1" data-astro-cid-wxiprx5h></path> </svg> <span data-astro-cid-wxiprx5h>Copy</span> </button>   <pre class="text-base overflow-x-auto" data-astro-cid-wxiprx5h><code class="language-{cell.type === 'bash' ? 'bash' : 'python'}" data-astro-cid-wxiprx5h>sections <span class="token operator">=</span> pdf<span class="token punctuation">.</span>get_sections<span class="token punctuation">(</span>
  <span class="token string">'text:contains(Recorded)'</span><span class="token punctuation">,</span>
  include_boundaries<span class="token operator">=</span><span class="token string">'start'</span>
<span class="token punctuation">)</span>
sections<span class="token punctuation">.</span>show<span class="token punctuation">(</span>cols<span class="token operator">=</span><span class="token number">3</span><span class="token punctuation">)</span></code></pre> </div> </div> <!-- Output --> <div class="output-section" data-astro-cid-wxiprx5h> <div class="bg-gray-50" data-astro-cid-wxiprx5h> <div class="p-4 font-mono text-base" data-astro-cid-wxiprx5h> <div class="text-xs text-gray-500 mb-2 uppercase tracking-wider" data-astro-cid-wxiprx5h>Output</div> <pre class="whitespace-pre-wrap text-gray-700" data-astro-cid-wxiprx5h>[DEBUG] Executing code: sections = pdf.get_sections(&#39;text:contains(Recorded)&#39;, include_boundaries=&#39;start&#39;)...
[DEBUG] Evaluating expression: sections.show(cols=3)...
</pre> </div> <div class="p-4" data-astro-cid-wxiprx5h> <a href="/artifacts/executions/pdfs/k046682-111320-opa-lea-database-install_1/k046682-111320-opa-lea-database-install_1/images/image_4.png" class="result-image" data-astro-cid-wxiprx5h> <img src="/artifacts/executions/pdfs/k046682-111320-opa-lea-database-install_1/k046682-111320-opa-lea-database-install_1/images/image_4.png" alt="Result" class="max-w-full cursor-zoom-in" data-astro-cid-wxiprx5h> </a>   </div>   </div> </div> </div> </div><div class="cell-container markdown-cell" data-astro-cid-wxiprx5h> <div class="prose prose-lg max-w-none prose-headings:text-gray-900 prose-h1:text-3xl prose-h2:text-2xl prose-h3:text-xl" data-astro-cid-wxiprx5h><p>Let&#39;s look at one of the sections.</p>
</div> </div><div id="code-4" class="cell-container " data-astro-cid-wxiprx5h> <div class="code-output-container space-y-1" data-astro-cid-wxiprx5h> <!-- Code Block --> <div class="code-section" data-astro-cid-wxiprx5h> <div class="bg-gray-900 text-gray-100 p-4 relative" data-astro-cid-wxiprx5h> <button class="copy-btn absolute top-2 right-2 px-2 py-1 text-xs bg-gray-800 hover:bg-gray-700 text-gray-300 hover:text-white rounded transition-colors cursor-pointer flex items-center gap-1" onclick="copyCode(this)" data-code="section = sections[3]
section.show(crop=True)" data-astro-cid-wxiprx5h> <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" data-astro-cid-wxiprx5h> <rect x="9" y="9" width="13" height="13" rx="2" ry="2" data-astro-cid-wxiprx5h></rect> <path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1" data-astro-cid-wxiprx5h></path> </svg> <span data-astro-cid-wxiprx5h>Copy</span> </button>   <pre class="text-base overflow-x-auto" data-astro-cid-wxiprx5h><code class="language-{cell.type === 'bash' ? 'bash' : 'python'}" data-astro-cid-wxiprx5h>section <span class="token operator">=</span> sections<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span>
section<span class="token punctuation">.</span>show<span class="token punctuation">(</span>crop<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span></code></pre> </div> </div> <!-- Output --> <div class="output-section" data-astro-cid-wxiprx5h> <div class="bg-gray-50" data-astro-cid-wxiprx5h> <div class="p-4 font-mono text-base" data-astro-cid-wxiprx5h> <div class="text-xs text-gray-500 mb-2 uppercase tracking-wider" data-astro-cid-wxiprx5h>Output</div> <pre class="whitespace-pre-wrap text-gray-700" data-astro-cid-wxiprx5h>[DEBUG] Executing code: section = sections[3]...
[DEBUG] Evaluating expression: section.show(crop=True)...
</pre> </div> <div class="p-4" data-astro-cid-wxiprx5h> <a href="/artifacts/executions/pdfs/k046682-111320-opa-lea-database-install_1/k046682-111320-opa-lea-database-install_1/images/image_5.png" class="result-image" data-astro-cid-wxiprx5h> <img src="/artifacts/executions/pdfs/k046682-111320-opa-lea-database-install_1/k046682-111320-opa-lea-database-install_1/images/image_5.png" alt="Result" class="max-w-full cursor-zoom-in" data-astro-cid-wxiprx5h> </a>   </div>   </div> </div> </div> </div><div class="cell-container markdown-cell" data-astro-cid-wxiprx5h> <div class="prose prose-lg max-w-none prose-headings:text-gray-900 prose-h1:text-3xl prose-h2:text-2xl prose-h3:text-xl" data-astro-cid-wxiprx5h><p>This extraction is made easier since <strong>they&#39;re all generally the same</strong>, they all have the same formatting even if they&#39;re missing data.</p>
<h2>Extracting the top area</h2>
<p>Up top we&#39;ll focus on grabbing the labels, then going right until we find a piece of text.</p>
</div> </div><div id="code-5" class="cell-container " data-astro-cid-wxiprx5h> <div class="code-output-container space-y-1" data-astro-cid-wxiprx5h> <!-- Code Block --> <div class="code-section" data-astro-cid-wxiprx5h> <div class="bg-gray-900 text-gray-100 p-4 relative" data-astro-cid-wxiprx5h> <button class="copy-btn absolute top-2 right-2 px-2 py-1 text-xs bg-gray-800 hover:bg-gray-700 text-gray-300 hover:text-white rounded transition-colors cursor-pointer flex items-center gap-1" onclick="copyCode(this)" data-code="complainant = (
  section
  .find(&#34;text:contains(Complainant)&#34;)
  .right(until='text')
)
print(&#34;Complainant is&#34;, complainant.extract_text())
complainant.show(crop=100)" data-astro-cid-wxiprx5h> <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" data-astro-cid-wxiprx5h> <rect x="9" y="9" width="13" height="13" rx="2" ry="2" data-astro-cid-wxiprx5h></rect> <path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1" data-astro-cid-wxiprx5h></path> </svg> <span data-astro-cid-wxiprx5h>Copy</span> </button>   <pre class="text-base overflow-x-auto" data-astro-cid-wxiprx5h><code class="language-{cell.type === 'bash' ? 'bash' : 'python'}" data-astro-cid-wxiprx5h>complainant <span class="token operator">=</span> <span class="token punctuation">(</span>
  section
  <span class="token punctuation">.</span>find<span class="token punctuation">(</span><span class="token string">"text:contains(Complainant)"</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span>right<span class="token punctuation">(</span>until<span class="token operator">=</span><span class="token string">'text'</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Complainant is"</span><span class="token punctuation">,</span> complainant<span class="token punctuation">.</span>extract_text<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
complainant<span class="token punctuation">.</span>show<span class="token punctuation">(</span>crop<span class="token operator">=</span><span class="token number">100</span><span class="token punctuation">)</span></code></pre> </div> </div> <!-- Output --> <div class="output-section" data-astro-cid-wxiprx5h> <div class="bg-gray-50" data-astro-cid-wxiprx5h> <div class="p-4 font-mono text-base" data-astro-cid-wxiprx5h> <div class="text-xs text-gray-500 mb-2 uppercase tracking-wider" data-astro-cid-wxiprx5h>Output</div> <pre class="whitespace-pre-wrap text-gray-700" data-astro-cid-wxiprx5h>[DEBUG] Executing code: complainant = section.find(&#39;text:contains(Complainant)&#39;).right(until=&#39;text&#39;)
print(&#39;Complainant is&#39;,...
Complainant is Shavlik, Lori D
[DEBUG] Evaluating expression: complainant.show(crop=100)...
</pre> </div> <div class="p-4" data-astro-cid-wxiprx5h> <a href="/artifacts/executions/pdfs/k046682-111320-opa-lea-database-install_1/k046682-111320-opa-lea-database-install_1/images/image_6.png" class="result-image" data-astro-cid-wxiprx5h> <img src="/artifacts/executions/pdfs/k046682-111320-opa-lea-database-install_1/k046682-111320-opa-lea-database-install_1/images/image_6.png" alt="Result" class="max-w-full cursor-zoom-in" data-astro-cid-wxiprx5h> </a>   </div>   </div> </div> </div> </div><div class="cell-container markdown-cell" data-astro-cid-wxiprx5h> <div class="prose prose-lg max-w-none prose-headings:text-gray-900 prose-h1:text-3xl prose-h2:text-2xl prose-h3:text-xl" data-astro-cid-wxiprx5h><p>Note that date of birth and some other fields are <em>missing</em>. Usually this means we&#39;d have to use <code>right(100)</code> or pick some manual pixel value, but it turns out even the missing data includes text elements - they&#39;re just empty! That means we can use <code>until=&#39;text&#39;</code> instead of magic numbers.</p>
</div> </div><div id="code-6" class="cell-container " data-astro-cid-wxiprx5h> <div class="code-output-container space-y-1" data-astro-cid-wxiprx5h> <!-- Code Block --> <div class="code-section" data-astro-cid-wxiprx5h> <div class="bg-gray-900 text-gray-100 p-4 relative" data-astro-cid-wxiprx5h> <button class="copy-btn absolute top-2 right-2 px-2 py-1 text-xs bg-gray-800 hover:bg-gray-700 text-gray-300 hover:text-white rounded transition-colors cursor-pointer flex items-center gap-1" onclick="copyCode(this)" data-code="dob = (
  section
  .find(&#34;text:contains(DOB)&#34;)
  .right(until='text')
)
print(&#34;DOB is&#34;, dob.extract_text())
dob.show(crop=100)" data-astro-cid-wxiprx5h> <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" data-astro-cid-wxiprx5h> <rect x="9" y="9" width="13" height="13" rx="2" ry="2" data-astro-cid-wxiprx5h></rect> <path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1" data-astro-cid-wxiprx5h></path> </svg> <span data-astro-cid-wxiprx5h>Copy</span> </button>   <pre class="text-base overflow-x-auto" data-astro-cid-wxiprx5h><code class="language-{cell.type === 'bash' ? 'bash' : 'python'}" data-astro-cid-wxiprx5h>dob <span class="token operator">=</span> <span class="token punctuation">(</span>
  section
  <span class="token punctuation">.</span>find<span class="token punctuation">(</span><span class="token string">"text:contains(DOB)"</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span>right<span class="token punctuation">(</span>until<span class="token operator">=</span><span class="token string">'text'</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"DOB is"</span><span class="token punctuation">,</span> dob<span class="token punctuation">.</span>extract_text<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
dob<span class="token punctuation">.</span>show<span class="token punctuation">(</span>crop<span class="token operator">=</span><span class="token number">100</span><span class="token punctuation">)</span></code></pre> </div> </div> <!-- Output --> <div class="output-section" data-astro-cid-wxiprx5h> <div class="bg-gray-50" data-astro-cid-wxiprx5h> <div class="p-4 font-mono text-base" data-astro-cid-wxiprx5h> <div class="text-xs text-gray-500 mb-2 uppercase tracking-wider" data-astro-cid-wxiprx5h>Output</div> <pre class="whitespace-pre-wrap text-gray-700" data-astro-cid-wxiprx5h>[DEBUG] Executing code: dob = section.find(&#39;text:contains(DOB)&#39;).right(until=&#39;text&#39;)
print(&#39;DOB is&#39;, dob.extract_text())...
DOB is 4/25/1969
[DEBUG] Evaluating expression: dob.show(crop=100)...
</pre> </div> <div class="p-4" data-astro-cid-wxiprx5h> <a href="/artifacts/executions/pdfs/k046682-111320-opa-lea-database-install_1/k046682-111320-opa-lea-database-install_1/images/image_7.png" class="result-image" data-astro-cid-wxiprx5h> <img src="/artifacts/executions/pdfs/k046682-111320-opa-lea-database-install_1/k046682-111320-opa-lea-database-install_1/images/image_7.png" alt="Result" class="max-w-full cursor-zoom-in" data-astro-cid-wxiprx5h> </a>   </div>   </div> </div> </div> </div><div class="cell-container markdown-cell" data-astro-cid-wxiprx5h> <div class="prose prose-lg max-w-none prose-headings:text-gray-900 prose-h1:text-3xl prose-h2:text-2xl prose-h3:text-xl" data-astro-cid-wxiprx5h><p>For the above/below pieces it&#39;s slightly more problematic. By default when you expand downwards, it doesn&#39;t select the <em>entire</em> piece of text, it only grabs the ones that intersect with your search area.</p>
</div> </div><div id="code-7" class="cell-container " data-astro-cid-wxiprx5h> <div class="code-output-container space-y-1" data-astro-cid-wxiprx5h> <!-- Code Block --> <div class="code-section" data-astro-cid-wxiprx5h> <div class="bg-gray-900 text-gray-100 p-4 relative" data-astro-cid-wxiprx5h> <button class="copy-btn absolute top-2 right-2 px-2 py-1 text-xs bg-gray-800 hover:bg-gray-700 text-gray-300 hover:text-white rounded transition-colors cursor-pointer flex items-center gap-1" onclick="copyCode(this)" data-code="number = (
    section
    .find(&#34;text:contains(Number)&#34;)
    .below(until='text', width='element')
)
print(&#34;Number is&#34;, number.extract_text())
number.show(crop=100)" data-astro-cid-wxiprx5h> <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" data-astro-cid-wxiprx5h> <rect x="9" y="9" width="13" height="13" rx="2" ry="2" data-astro-cid-wxiprx5h></rect> <path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1" data-astro-cid-wxiprx5h></path> </svg> <span data-astro-cid-wxiprx5h>Copy</span> </button>   <pre class="text-base overflow-x-auto" data-astro-cid-wxiprx5h><code class="language-{cell.type === 'bash' ? 'bash' : 'python'}" data-astro-cid-wxiprx5h>number <span class="token operator">=</span> <span class="token punctuation">(</span>
    section
    <span class="token punctuation">.</span>find<span class="token punctuation">(</span><span class="token string">"text:contains(Number)"</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span>below<span class="token punctuation">(</span>until<span class="token operator">=</span><span class="token string">'text'</span><span class="token punctuation">,</span> width<span class="token operator">=</span><span class="token string">'element'</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Number is"</span><span class="token punctuation">,</span> number<span class="token punctuation">.</span>extract_text<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
number<span class="token punctuation">.</span>show<span class="token punctuation">(</span>crop<span class="token operator">=</span><span class="token number">100</span><span class="token punctuation">)</span></code></pre> </div> </div> <!-- Output --> <div class="output-section" data-astro-cid-wxiprx5h> <div class="bg-gray-50" data-astro-cid-wxiprx5h> <div class="p-4 font-mono text-base" data-astro-cid-wxiprx5h> <div class="text-xs text-gray-500 mb-2 uppercase tracking-wider" data-astro-cid-wxiprx5h>Output</div> <pre class="whitespace-pre-wrap text-gray-700" data-astro-cid-wxiprx5h>[DEBUG] Executing code: number = section.find(&#39;text:contains(Number)&#39;).below(until=&#39;text&#39;, width=&#39;element&#39;)
print(&#39;Number is...
Number is 16-002
[DEBUG] Evaluating expression: number.show(crop=100)...
</pre> </div> <div class="p-4" data-astro-cid-wxiprx5h> <a href="/artifacts/executions/pdfs/k046682-111320-opa-lea-database-install_1/k046682-111320-opa-lea-database-install_1/images/image_8.png" class="result-image" data-astro-cid-wxiprx5h> <img src="/artifacts/executions/pdfs/k046682-111320-opa-lea-database-install_1/k046682-111320-opa-lea-database-install_1/images/image_8.png" alt="Result" class="max-w-full cursor-zoom-in" data-astro-cid-wxiprx5h> </a>   </div>   </div> </div> </div> </div><div class="cell-container markdown-cell" data-astro-cid-wxiprx5h> <div class="prose prose-lg max-w-none prose-headings:text-gray-900 prose-h1:text-3xl prose-h2:text-2xl prose-h3:text-xl" data-astro-cid-wxiprx5h><p>In order to be sure you get the entire thing you need to ask for text that even partially overlaps the area you have selected. This makes the area expand to cover all of the number.</p>
</div> </div><div id="code-8" class="cell-container " data-astro-cid-wxiprx5h> <div class="code-output-container space-y-1" data-astro-cid-wxiprx5h> <!-- Code Block --> <div class="code-section" data-astro-cid-wxiprx5h> <div class="bg-gray-900 text-gray-100 p-4 relative" data-astro-cid-wxiprx5h> <button class="copy-btn absolute top-2 right-2 px-2 py-1 text-xs bg-gray-800 hover:bg-gray-700 text-gray-300 hover:text-white rounded transition-colors cursor-pointer flex items-center gap-1" onclick="copyCode(this)" data-code="number = (
    section
    .find(&#34;text:contains(Number)&#34;)
    .below(until='text', width='element')
    .find('text', overlap='partial')
)
print(&#34;Number is&#34;, number.extract_text())
number.show(crop=100)" data-astro-cid-wxiprx5h> <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" data-astro-cid-wxiprx5h> <rect x="9" y="9" width="13" height="13" rx="2" ry="2" data-astro-cid-wxiprx5h></rect> <path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1" data-astro-cid-wxiprx5h></path> </svg> <span data-astro-cid-wxiprx5h>Copy</span> </button>   <pre class="text-base overflow-x-auto" data-astro-cid-wxiprx5h><code class="language-{cell.type === 'bash' ? 'bash' : 'python'}" data-astro-cid-wxiprx5h>number <span class="token operator">=</span> <span class="token punctuation">(</span>
    section
    <span class="token punctuation">.</span>find<span class="token punctuation">(</span><span class="token string">"text:contains(Number)"</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span>below<span class="token punctuation">(</span>until<span class="token operator">=</span><span class="token string">'text'</span><span class="token punctuation">,</span> width<span class="token operator">=</span><span class="token string">'element'</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span>find<span class="token punctuation">(</span><span class="token string">'text'</span><span class="token punctuation">,</span> overlap<span class="token operator">=</span><span class="token string">'partial'</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Number is"</span><span class="token punctuation">,</span> number<span class="token punctuation">.</span>extract_text<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
number<span class="token punctuation">.</span>show<span class="token punctuation">(</span>crop<span class="token operator">=</span><span class="token number">100</span><span class="token punctuation">)</span></code></pre> </div> </div> <!-- Output --> <div class="output-section" data-astro-cid-wxiprx5h> <div class="bg-gray-50" data-astro-cid-wxiprx5h> <div class="p-4 font-mono text-base" data-astro-cid-wxiprx5h> <div class="text-xs text-gray-500 mb-2 uppercase tracking-wider" data-astro-cid-wxiprx5h>Output</div> <pre class="whitespace-pre-wrap text-gray-700" data-astro-cid-wxiprx5h>[DEBUG] Executing code: number = section.find(&#39;text:contains(Number)&#39;).below(until=&#39;text&#39;, width=&#39;element&#39;).find(&#39;text&#39;, ove...
Number is 16-002 IA
[DEBUG] Evaluating expression: number.show(crop=100)...
</pre> </div> <div class="p-4" data-astro-cid-wxiprx5h> <a href="/artifacts/executions/pdfs/k046682-111320-opa-lea-database-install_1/k046682-111320-opa-lea-database-install_1/images/image_9.png" class="result-image" data-astro-cid-wxiprx5h> <img src="/artifacts/executions/pdfs/k046682-111320-opa-lea-database-install_1/k046682-111320-opa-lea-database-install_1/images/image_9.png" alt="Result" class="max-w-full cursor-zoom-in" data-astro-cid-wxiprx5h> </a>   </div>   </div> </div> </div> </div><div class="cell-container markdown-cell" data-astro-cid-wxiprx5h> <div class="prose prose-lg max-w-none prose-headings:text-gray-900 prose-h1:text-3xl prose-h2:text-2xl prose-h3:text-xl" data-astro-cid-wxiprx5h><p>The elements like &quot;Date Assigned&quot; and &quot;Completed&quot; are a little more difficult, as you want to be sure you&#39;re only grabbing the text <em>fully and directly underneath</em> the label.</p>
</div> </div><div id="code-9" class="cell-container " data-astro-cid-wxiprx5h> <div class="code-output-container space-y-1" data-astro-cid-wxiprx5h> <!-- Code Block --> <div class="code-section" data-astro-cid-wxiprx5h> <div class="bg-gray-900 text-gray-100 p-4 relative" data-astro-cid-wxiprx5h> <button class="copy-btn absolute top-2 right-2 px-2 py-1 text-xs bg-gray-800 hover:bg-gray-700 text-gray-300 hover:text-white rounded transition-colors cursor-pointer flex items-center gap-1" onclick="copyCode(this)" data-code="(
  section
  .find('text:contains(Date Assigned)')
  .below(width='element')
  .show(crop=100)
)" data-astro-cid-wxiprx5h> <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" data-astro-cid-wxiprx5h> <rect x="9" y="9" width="13" height="13" rx="2" ry="2" data-astro-cid-wxiprx5h></rect> <path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1" data-astro-cid-wxiprx5h></path> </svg> <span data-astro-cid-wxiprx5h>Copy</span> </button>   <pre class="text-base overflow-x-auto" data-astro-cid-wxiprx5h><code class="language-{cell.type === 'bash' ? 'bash' : 'python'}" data-astro-cid-wxiprx5h><span class="token punctuation">(</span>
  section
  <span class="token punctuation">.</span>find<span class="token punctuation">(</span><span class="token string">'text:contains(Date Assigned)'</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span>below<span class="token punctuation">(</span>width<span class="token operator">=</span><span class="token string">'element'</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span>show<span class="token punctuation">(</span>crop<span class="token operator">=</span><span class="token number">100</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span></code></pre> </div> </div> <!-- Output --> <div class="output-section" data-astro-cid-wxiprx5h> <div class="bg-gray-50" data-astro-cid-wxiprx5h> <div class="p-4 font-mono text-base" data-astro-cid-wxiprx5h> <div class="text-xs text-gray-500 mb-2 uppercase tracking-wider" data-astro-cid-wxiprx5h>Output</div> <pre class="whitespace-pre-wrap text-gray-700" data-astro-cid-wxiprx5h>[DEBUG] Evaluating expression: section.find(&#39;text:contains(Date Assigned)&#39;).below(width=&#39;element&#39;).show(crop=100)...
</pre> </div> <div class="p-4" data-astro-cid-wxiprx5h> <a href="/artifacts/executions/pdfs/k046682-111320-opa-lea-database-install_1/k046682-111320-opa-lea-database-install_1/images/image_10.png" class="result-image" data-astro-cid-wxiprx5h> <img src="/artifacts/executions/pdfs/k046682-111320-opa-lea-database-install_1/k046682-111320-opa-lea-database-install_1/images/image_10.png" alt="Result" class="max-w-full cursor-zoom-in" data-astro-cid-wxiprx5h> </a>   </div>   </div> </div> </div> </div><div class="cell-container markdown-cell" data-astro-cid-wxiprx5h> <div class="prose prose-lg max-w-none prose-headings:text-gray-900 prose-h1:text-3xl prose-h2:text-2xl prose-h3:text-xl" data-astro-cid-wxiprx5h><p>We do this by grabbing the area below, then asking it to find the first piece of text inside the created box full overlap. By default it only picks text that is <em>fully inside</em>.</p>
</div> </div><div id="code-10" class="cell-container " data-astro-cid-wxiprx5h> <div class="code-output-container space-y-1" data-astro-cid-wxiprx5h> <!-- Code Block --> <div class="code-section" data-astro-cid-wxiprx5h> <div class="bg-gray-900 text-gray-100 p-4 relative" data-astro-cid-wxiprx5h> <button class="copy-btn absolute top-2 right-2 px-2 py-1 text-xs bg-gray-800 hover:bg-gray-700 text-gray-300 hover:text-white rounded transition-colors cursor-pointer flex items-center gap-1" onclick="copyCode(this)" data-code="(
  section
  .find('text:contains(Date Assigned)')
  .below(width='element')
  .find('text')
  .extract_text()
)" data-astro-cid-wxiprx5h> <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" data-astro-cid-wxiprx5h> <rect x="9" y="9" width="13" height="13" rx="2" ry="2" data-astro-cid-wxiprx5h></rect> <path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1" data-astro-cid-wxiprx5h></path> </svg> <span data-astro-cid-wxiprx5h>Copy</span> </button>   <pre class="text-base overflow-x-auto" data-astro-cid-wxiprx5h><code class="language-{cell.type === 'bash' ? 'bash' : 'python'}" data-astro-cid-wxiprx5h><span class="token punctuation">(</span>
  section
  <span class="token punctuation">.</span>find<span class="token punctuation">(</span><span class="token string">'text:contains(Date Assigned)'</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span>below<span class="token punctuation">(</span>width<span class="token operator">=</span><span class="token string">'element'</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span>find<span class="token punctuation">(</span><span class="token string">'text'</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span>extract_text<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span></code></pre> </div> </div> <!-- Output --> <div class="output-section" data-astro-cid-wxiprx5h> <div class="bg-gray-50" data-astro-cid-wxiprx5h> <div class="p-4 font-mono text-base" data-astro-cid-wxiprx5h> <div class="text-xs text-gray-500 mb-2 uppercase tracking-wider" data-astro-cid-wxiprx5h>Output</div> <pre class="whitespace-pre-wrap text-gray-700" data-astro-cid-wxiprx5h>[DEBUG] Evaluating expression: section.find(&#39;text:contains(Date Assigned)&#39;).below(width=&#39;element&#39;).find(&#39;text&#39;).extract_text()...
</pre> </div> <div class="p-4" data-astro-cid-wxiprx5h>   <pre class="font-mono text-base whitespace-pre-wrap text-gray-800" data-astro-cid-wxiprx5h>&#39;1/6/2016&#39;</pre> </div>   </div> </div> </div> </div><div class="cell-container markdown-cell" data-astro-cid-wxiprx5h> <div class="prose prose-lg max-w-none prose-headings:text-gray-900 prose-h1:text-3xl prose-h2:text-2xl prose-h3:text-xl" data-astro-cid-wxiprx5h><p>If we did <code>until=&#39;text&#39;</code> it would grab the <em>first text it touched</em>, so it would grab the Seargant.</p>
<p>With that all in line, when we start to grab them all it looks something like this:</p>
</div> </div><div id="code-11" class="cell-container " data-astro-cid-wxiprx5h> <div class="code-output-container space-y-1" data-astro-cid-wxiprx5h> <!-- Code Block --> <div class="code-section" data-astro-cid-wxiprx5h> <div class="bg-gray-900 text-gray-100 p-4 relative" data-astro-cid-wxiprx5h> <button class="copy-btn absolute top-2 right-2 px-2 py-1 text-xs bg-gray-800 hover:bg-gray-700 text-gray-300 hover:text-white rounded transition-colors cursor-pointer flex items-center gap-1" onclick="copyCode(this)" data-code="complainant = (
  section
  .find(&#34;text:contains(Complainant)&#34;)
  .right(until='text')
)
dob = (
  section
  .find(&#34;text:contains(DOB)&#34;)
  .right(until='text')
)
address = (
  section
  .find(&#34;text:contains(Address)&#34;)
  .right(until='text')
)
gender = (
  section
  .find(&#34;text:contains(Gender)&#34;)
  .right(until='text')
)
phone = (
  section
  .find(&#34;text:contains(H Phone)&#34;)
  .right(until='text')
)
date_assigned = (
  section
  .find('text:contains(Date Assigned)')
  .below(width='element')
  .find('text')
)
completed = (
  section
  .find('text:contains(Completed)')
  .below(width='element')
  .find('text')
)
recorded = (
  section
  .find('text:contains(Recorded)')
  .below(until='text', width='element')
)

(complainant + dob + address + gender + phone + date_assigned + completed + recorded).show(crop=section)" data-astro-cid-wxiprx5h> <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" data-astro-cid-wxiprx5h> <rect x="9" y="9" width="13" height="13" rx="2" ry="2" data-astro-cid-wxiprx5h></rect> <path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1" data-astro-cid-wxiprx5h></path> </svg> <span data-astro-cid-wxiprx5h>Copy</span> </button>   <pre class="text-base overflow-x-auto" data-astro-cid-wxiprx5h><code class="language-{cell.type === 'bash' ? 'bash' : 'python'}" data-astro-cid-wxiprx5h>complainant <span class="token operator">=</span> <span class="token punctuation">(</span>
  section
  <span class="token punctuation">.</span>find<span class="token punctuation">(</span><span class="token string">"text:contains(Complainant)"</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span>right<span class="token punctuation">(</span>until<span class="token operator">=</span><span class="token string">'text'</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span>
dob <span class="token operator">=</span> <span class="token punctuation">(</span>
  section
  <span class="token punctuation">.</span>find<span class="token punctuation">(</span><span class="token string">"text:contains(DOB)"</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span>right<span class="token punctuation">(</span>until<span class="token operator">=</span><span class="token string">'text'</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span>
address <span class="token operator">=</span> <span class="token punctuation">(</span>
  section
  <span class="token punctuation">.</span>find<span class="token punctuation">(</span><span class="token string">"text:contains(Address)"</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span>right<span class="token punctuation">(</span>until<span class="token operator">=</span><span class="token string">'text'</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span>
gender <span class="token operator">=</span> <span class="token punctuation">(</span>
  section
  <span class="token punctuation">.</span>find<span class="token punctuation">(</span><span class="token string">"text:contains(Gender)"</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span>right<span class="token punctuation">(</span>until<span class="token operator">=</span><span class="token string">'text'</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span>
phone <span class="token operator">=</span> <span class="token punctuation">(</span>
  section
  <span class="token punctuation">.</span>find<span class="token punctuation">(</span><span class="token string">"text:contains(H Phone)"</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span>right<span class="token punctuation">(</span>until<span class="token operator">=</span><span class="token string">'text'</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span>
date_assigned <span class="token operator">=</span> <span class="token punctuation">(</span>
  section
  <span class="token punctuation">.</span>find<span class="token punctuation">(</span><span class="token string">'text:contains(Date Assigned)'</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span>below<span class="token punctuation">(</span>width<span class="token operator">=</span><span class="token string">'element'</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span>find<span class="token punctuation">(</span><span class="token string">'text'</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span>
completed <span class="token operator">=</span> <span class="token punctuation">(</span>
  section
  <span class="token punctuation">.</span>find<span class="token punctuation">(</span><span class="token string">'text:contains(Completed)'</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span>below<span class="token punctuation">(</span>width<span class="token operator">=</span><span class="token string">'element'</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span>find<span class="token punctuation">(</span><span class="token string">'text'</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span>
recorded <span class="token operator">=</span> <span class="token punctuation">(</span>
  section
  <span class="token punctuation">.</span>find<span class="token punctuation">(</span><span class="token string">'text:contains(Recorded)'</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span>below<span class="token punctuation">(</span>until<span class="token operator">=</span><span class="token string">'text'</span><span class="token punctuation">,</span> width<span class="token operator">=</span><span class="token string">'element'</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span>

<span class="token punctuation">(</span>complainant <span class="token operator">+</span> dob <span class="token operator">+</span> address <span class="token operator">+</span> gender <span class="token operator">+</span> phone <span class="token operator">+</span> date_assigned <span class="token operator">+</span> completed <span class="token operator">+</span> recorded<span class="token punctuation">)</span><span class="token punctuation">.</span>show<span class="token punctuation">(</span>crop<span class="token operator">=</span>section<span class="token punctuation">)</span></code></pre> </div> </div> <!-- Output --> <div class="output-section" data-astro-cid-wxiprx5h> <div class="bg-gray-50" data-astro-cid-wxiprx5h> <div class="p-4 font-mono text-base" data-astro-cid-wxiprx5h> <div class="text-xs text-gray-500 mb-2 uppercase tracking-wider" data-astro-cid-wxiprx5h>Output</div> <pre class="whitespace-pre-wrap text-gray-700" data-astro-cid-wxiprx5h>[DEBUG] Executing code: complainant = section.find(&#39;text:contains(Complainant)&#39;).right(until=&#39;text&#39;)
dob = section.find(&#39;tex...
[DEBUG] Evaluating expression: (complainant + dob + address + gender + phone + date_assigned + completed + recorded).show(crop=sect...
</pre> </div> <div class="p-4" data-astro-cid-wxiprx5h> <a href="/artifacts/executions/pdfs/k046682-111320-opa-lea-database-install_1/k046682-111320-opa-lea-database-install_1/images/image_11.png" class="result-image" data-astro-cid-wxiprx5h> <img src="/artifacts/executions/pdfs/k046682-111320-opa-lea-database-install_1/k046682-111320-opa-lea-database-install_1/images/image_11.png" alt="Result" class="max-w-full cursor-zoom-in" data-astro-cid-wxiprx5h> </a>   </div>   </div> </div> </div> </div><div class="cell-container markdown-cell" data-astro-cid-wxiprx5h> <div class="prose prose-lg max-w-none prose-headings:text-gray-900 prose-h1:text-3xl prose-h2:text-2xl prose-h3:text-xl" data-astro-cid-wxiprx5h><blockquote>
<p>I&#39;m sorry, I got lazy â€“ I trust you understand and can fill the rest of them out on your own!</p>
</blockquote>
<h2>Capturing the complaint table</h2>
<p>The tables might seem intimidating, but it&#39;s really only a question of isolating the area and then using <code>.extract_table()</code>.</p>
<p>How can we describe the &quot;Complaint&quot; area? Well, it&#39;s **to the right of a bunch of <code>Complaint #</code> text.</p>
</div> </div><div id="code-12" class="cell-container " data-astro-cid-wxiprx5h> <div class="code-output-container space-y-1" data-astro-cid-wxiprx5h> <!-- Code Block --> <div class="code-section" data-astro-cid-wxiprx5h> <div class="bg-gray-900 text-gray-100 p-4 relative" data-astro-cid-wxiprx5h> <button class="copy-btn absolute top-2 right-2 px-2 py-1 text-xs bg-gray-800 hover:bg-gray-700 text-gray-300 hover:text-white rounded transition-colors cursor-pointer flex items-center gap-1" onclick="copyCode(this)" data-code="(
    section
    .find_all('text:contains(Complaint #)')
    .right(include_source=True)
    .show(crop=section)
)" data-astro-cid-wxiprx5h> <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" data-astro-cid-wxiprx5h> <rect x="9" y="9" width="13" height="13" rx="2" ry="2" data-astro-cid-wxiprx5h></rect> <path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1" data-astro-cid-wxiprx5h></path> </svg> <span data-astro-cid-wxiprx5h>Copy</span> </button>   <pre class="text-base overflow-x-auto" data-astro-cid-wxiprx5h><code class="language-{cell.type === 'bash' ? 'bash' : 'python'}" data-astro-cid-wxiprx5h><span class="token punctuation">(</span>
    section
    <span class="token punctuation">.</span>find_all<span class="token punctuation">(</span><span class="token string">'text:contains(Complaint #)'</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span>right<span class="token punctuation">(</span>include_source<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span>show<span class="token punctuation">(</span>crop<span class="token operator">=</span>section<span class="token punctuation">)</span>
<span class="token punctuation">)</span></code></pre> </div> </div> <!-- Output --> <div class="output-section" data-astro-cid-wxiprx5h> <div class="bg-gray-50" data-astro-cid-wxiprx5h> <div class="p-4 font-mono text-base" data-astro-cid-wxiprx5h> <div class="text-xs text-gray-500 mb-2 uppercase tracking-wider" data-astro-cid-wxiprx5h>Output</div> <pre class="whitespace-pre-wrap text-gray-700" data-astro-cid-wxiprx5h>[DEBUG] Evaluating expression: section.find_all(&#39;text:contains(Complaint #)&#39;).right(include_source=True).show(crop=section)...
</pre> </div> <div class="p-4" data-astro-cid-wxiprx5h> <a href="/artifacts/executions/pdfs/k046682-111320-opa-lea-database-install_1/k046682-111320-opa-lea-database-install_1/images/image_12.png" class="result-image" data-astro-cid-wxiprx5h> <img src="/artifacts/executions/pdfs/k046682-111320-opa-lea-database-install_1/k046682-111320-opa-lea-database-install_1/images/image_12.png" alt="Result" class="max-w-full cursor-zoom-in" data-astro-cid-wxiprx5h> </a>   </div>   </div> </div> </div> </div><div class="cell-container markdown-cell" data-astro-cid-wxiprx5h> <div class="prose prose-lg max-w-none prose-headings:text-gray-900 prose-h1:text-3xl prose-h2:text-2xl prose-h3:text-xl" data-astro-cid-wxiprx5h><p>We could probably grab each of the text elements individually and parse out the columns, but instead we&#39;ll use <code>.merge()</code> to combine them into one big region, then nudge it up and down a little bit to capture the entire table.</p>
</div> </div><div id="code-13" class="cell-container " data-astro-cid-wxiprx5h> <div class="code-output-container space-y-1" data-astro-cid-wxiprx5h> <!-- Code Block --> <div class="code-section" data-astro-cid-wxiprx5h> <div class="bg-gray-900 text-gray-100 p-4 relative" data-astro-cid-wxiprx5h> <button class="copy-btn absolute top-2 right-2 px-2 py-1 text-xs bg-gray-800 hover:bg-gray-700 text-gray-300 hover:text-white rounded transition-colors cursor-pointer flex items-center gap-1" onclick="copyCode(this)" data-code="(
    section
    .find_all('text:contains(Complaint #)')
    .right(include_source=True)
    .merge()
    .expand(top=5, bottom=7)
    .show(crop=section)
)" data-astro-cid-wxiprx5h> <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" data-astro-cid-wxiprx5h> <rect x="9" y="9" width="13" height="13" rx="2" ry="2" data-astro-cid-wxiprx5h></rect> <path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1" data-astro-cid-wxiprx5h></path> </svg> <span data-astro-cid-wxiprx5h>Copy</span> </button>   <pre class="text-base overflow-x-auto" data-astro-cid-wxiprx5h><code class="language-{cell.type === 'bash' ? 'bash' : 'python'}" data-astro-cid-wxiprx5h><span class="token punctuation">(</span>
    section
    <span class="token punctuation">.</span>find_all<span class="token punctuation">(</span><span class="token string">'text:contains(Complaint #)'</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span>right<span class="token punctuation">(</span>include_source<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span>merge<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span>expand<span class="token punctuation">(</span>top<span class="token operator">=</span><span class="token number">5</span><span class="token punctuation">,</span> bottom<span class="token operator">=</span><span class="token number">7</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span>show<span class="token punctuation">(</span>crop<span class="token operator">=</span>section<span class="token punctuation">)</span>
<span class="token punctuation">)</span></code></pre> </div> </div> <!-- Output --> <div class="output-section" data-astro-cid-wxiprx5h> <div class="bg-gray-50" data-astro-cid-wxiprx5h> <div class="p-4 font-mono text-base" data-astro-cid-wxiprx5h> <div class="text-xs text-gray-500 mb-2 uppercase tracking-wider" data-astro-cid-wxiprx5h>Output</div> <pre class="whitespace-pre-wrap text-gray-700" data-astro-cid-wxiprx5h>[DEBUG] Evaluating expression: section.find_all(&#39;text:contains(Complaint #)&#39;).right(include_source=True).merge().expand(top=5, bott...
</pre> </div> <div class="p-4" data-astro-cid-wxiprx5h> <a href="/artifacts/executions/pdfs/k046682-111320-opa-lea-database-install_1/k046682-111320-opa-lea-database-install_1/images/image_13.png" class="result-image" data-astro-cid-wxiprx5h> <img src="/artifacts/executions/pdfs/k046682-111320-opa-lea-database-install_1/k046682-111320-opa-lea-database-install_1/images/image_13.png" alt="Result" class="max-w-full cursor-zoom-in" data-astro-cid-wxiprx5h> </a>   </div>   </div> </div> </div> </div><div class="cell-container markdown-cell" data-astro-cid-wxiprx5h> <div class="prose prose-lg max-w-none prose-headings:text-gray-900 prose-h1:text-3xl prose-h2:text-2xl prose-h3:text-xl" data-astro-cid-wxiprx5h><p>It&#39;s too much work to try to capture the headers programmatically, so we&#39;ll just manually type them in.</p>
</div> </div><div id="code-14" class="cell-container " data-astro-cid-wxiprx5h> <div class="code-output-container space-y-1" data-astro-cid-wxiprx5h> <!-- Code Block --> <div class="code-section" data-astro-cid-wxiprx5h> <div class="bg-gray-900 text-gray-100 p-4 relative" data-astro-cid-wxiprx5h> <button class="copy-btn absolute top-2 right-2 px-2 py-1 text-xs bg-gray-800 hover:bg-gray-700 text-gray-300 hover:text-white rounded transition-colors cursor-pointer flex items-center gap-1" onclick="copyCode(this)" data-code="(
    section
    .find_all('text:contains(Complaint #)')
    .right(include_source=True)
    .merge()
    .expand(top=5, bottom=7)
    .extract_table()
    .to_df(header=['Type of Complaint', 'Description', 'Complaint Disposition'])
)" data-astro-cid-wxiprx5h> <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" data-astro-cid-wxiprx5h> <rect x="9" y="9" width="13" height="13" rx="2" ry="2" data-astro-cid-wxiprx5h></rect> <path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1" data-astro-cid-wxiprx5h></path> </svg> <span data-astro-cid-wxiprx5h>Copy</span> </button>   <pre class="text-base overflow-x-auto" data-astro-cid-wxiprx5h><code class="language-{cell.type === 'bash' ? 'bash' : 'python'}" data-astro-cid-wxiprx5h><span class="token punctuation">(</span>
    section
    <span class="token punctuation">.</span>find_all<span class="token punctuation">(</span><span class="token string">'text:contains(Complaint #)'</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span>right<span class="token punctuation">(</span>include_source<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span>merge<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span>expand<span class="token punctuation">(</span>top<span class="token operator">=</span><span class="token number">5</span><span class="token punctuation">,</span> bottom<span class="token operator">=</span><span class="token number">7</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span>extract_table<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span>to_df<span class="token punctuation">(</span>header<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'Type of Complaint'</span><span class="token punctuation">,</span> <span class="token string">'Description'</span><span class="token punctuation">,</span> <span class="token string">'Complaint Disposition'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span></code></pre> </div> </div> <!-- Output --> <div class="output-section" data-astro-cid-wxiprx5h> <div class="bg-gray-50" data-astro-cid-wxiprx5h> <div class="p-4 font-mono text-base" data-astro-cid-wxiprx5h> <div class="text-xs text-gray-500 mb-2 uppercase tracking-wider" data-astro-cid-wxiprx5h>Output</div> <pre class="whitespace-pre-wrap text-gray-700" data-astro-cid-wxiprx5h>[DEBUG] Evaluating expression: section.find_all(&#39;text:contains(Complaint #)&#39;).right(include_source=True).merge().expand(top=5, bott...
</pre> </div> <div class="p-4" data-astro-cid-wxiprx5h>  <div class="overflow-x-auto dataframe-container prose prose-sm max-w-none" data-astro-cid-wxiprx5h><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Type of Complaint</th>
      <th>Description</th>
      <th>Complaint Disposition</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>7.2.1</td>
      <td>Affirmatively Promoting a Positive Public I</td>
      <td>Non-Sustained (a)</td>
    </tr>
    <tr>
      <th>1</th>
      <td>7.2.3</td>
      <td>Observe Criminal Civil Laws</td>
      <td>Non-Sustained (a)</td>
    </tr>
    <tr>
      <th>2</th>
      <td>7.2.4</td>
      <td>Dishonesty or Untruthfulness</td>
      <td>Non-Sustained (a)</td>
    </tr>
    <tr>
      <th>3</th>
      <td>7.2.5</td>
      <td>Display Competent Performance</td>
      <td>Non-Sustained (a)</td>
    </tr>
  </tbody>
</table>
</div></div>  </div>   </div> </div> </div> </div><div class="cell-container markdown-cell" data-astro-cid-wxiprx5h> <div class="prose prose-lg max-w-none prose-headings:text-gray-900 prose-h1:text-3xl prose-h2:text-2xl prose-h3:text-xl" data-astro-cid-wxiprx5h><p>Unfortunately this doesn&#39;t work on all of the tables: some of the ones with redactions trick the columnd detector! So we&#39;ll use <strong>Guides</strong> to detect a <em>specific number of columns</em> based on the lines.</p>
</div> </div><div id="code-15" class="cell-container " data-astro-cid-wxiprx5h> <div class="code-output-container space-y-1" data-astro-cid-wxiprx5h> <!-- Code Block --> <div class="code-section" data-astro-cid-wxiprx5h> <div class="bg-gray-900 text-gray-100 p-4 relative" data-astro-cid-wxiprx5h> <button class="copy-btn absolute top-2 right-2 px-2 py-1 text-xs bg-gray-800 hover:bg-gray-700 text-gray-300 hover:text-white rounded transition-colors cursor-pointer flex items-center gap-1" onclick="copyCode(this)" data-code="from natural_pdf.analyzers.guides import Guides

# Find the area
table = (
    section
    .find_all('text:contains(Complaint #)')
    .right(include_source=True)
    .merge()
    .expand(top=5, bottom=7)
)

# Build vertical guidelines from lines
guides = Guides(table)
guides.vertical.from_lines(n=4)

# Use the guides
(
  table
  .extract_table(verticals=guides.vertical)
  .to_df(header=['Type of Complaint', 'Description', 'Complaint Disposition'])
)" data-astro-cid-wxiprx5h> <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" data-astro-cid-wxiprx5h> <rect x="9" y="9" width="13" height="13" rx="2" ry="2" data-astro-cid-wxiprx5h></rect> <path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1" data-astro-cid-wxiprx5h></path> </svg> <span data-astro-cid-wxiprx5h>Copy</span> </button>   <pre class="text-base overflow-x-auto" data-astro-cid-wxiprx5h><code class="language-{cell.type === 'bash' ? 'bash' : 'python'}" data-astro-cid-wxiprx5h><span class="token keyword">from</span> natural_pdf<span class="token punctuation">.</span>analyzers<span class="token punctuation">.</span>guides <span class="token keyword">import</span> Guides

<span class="token comment"># Find the area</span>
table <span class="token operator">=</span> <span class="token punctuation">(</span>
    section
    <span class="token punctuation">.</span>find_all<span class="token punctuation">(</span><span class="token string">'text:contains(Complaint #)'</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span>right<span class="token punctuation">(</span>include_source<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span>merge<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span>expand<span class="token punctuation">(</span>top<span class="token operator">=</span><span class="token number">5</span><span class="token punctuation">,</span> bottom<span class="token operator">=</span><span class="token number">7</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span>

<span class="token comment"># Build vertical guidelines from lines</span>
guides <span class="token operator">=</span> Guides<span class="token punctuation">(</span>table<span class="token punctuation">)</span>
guides<span class="token punctuation">.</span>vertical<span class="token punctuation">.</span>from_lines<span class="token punctuation">(</span>n<span class="token operator">=</span><span class="token number">4</span><span class="token punctuation">)</span>

<span class="token comment"># Use the guides</span>
<span class="token punctuation">(</span>
  table
  <span class="token punctuation">.</span>extract_table<span class="token punctuation">(</span>verticals<span class="token operator">=</span>guides<span class="token punctuation">.</span>vertical<span class="token punctuation">)</span>
  <span class="token punctuation">.</span>to_df<span class="token punctuation">(</span>header<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'Type of Complaint'</span><span class="token punctuation">,</span> <span class="token string">'Description'</span><span class="token punctuation">,</span> <span class="token string">'Complaint Disposition'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span></code></pre> </div> </div> <!-- Output --> <div class="output-section" data-astro-cid-wxiprx5h> <div class="bg-gray-50" data-astro-cid-wxiprx5h> <div class="p-4 font-mono text-base" data-astro-cid-wxiprx5h> <div class="text-xs text-gray-500 mb-2 uppercase tracking-wider" data-astro-cid-wxiprx5h>Output</div> <pre class="whitespace-pre-wrap text-gray-700" data-astro-cid-wxiprx5h>[DEBUG] Executing code: from natural_pdf.analyzers.guides import Guides
table = section.find_all(&#39;text:contains(Complaint #)...
[DEBUG] Evaluating expression: table.extract_table(verticals=guides.vertical).to_df(header=[&#39;Type of Complaint&#39;, &#39;Description&#39;, &#39;Co...
</pre> </div> <div class="p-4" data-astro-cid-wxiprx5h>  <div class="overflow-x-auto dataframe-container prose prose-sm max-w-none" data-astro-cid-wxiprx5h><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Type of Complaint</th>
      <th>Description</th>
      <th>Complaint Disposition</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>7.2.1</td>
      <td>Affirmatively Promoting a Positive Public I</td>
      <td>Non-Sustained (a)</td>
    </tr>
    <tr>
      <th>1</th>
      <td>7.2.3</td>
      <td>Observe Criminal Civil Laws</td>
      <td>Non-Sustained (a)</td>
    </tr>
    <tr>
      <th>2</th>
      <td>7.2.4</td>
      <td>Dishonesty or Untruthfulness</td>
      <td>Non-Sustained (a)</td>
    </tr>
    <tr>
      <th>3</th>
      <td>7.2.5</td>
      <td>Display Competent Performance</td>
      <td>Non-Sustained (a)</td>
    </tr>
  </tbody>
</table>
</div></div>  </div>   </div> </div> </div> </div><div class="cell-container markdown-cell" data-astro-cid-wxiprx5h> <div class="prose prose-lg max-w-none prose-headings:text-gray-900 prose-h1:text-3xl prose-h2:text-2xl prose-h3:text-xl" data-astro-cid-wxiprx5h><h2>Capturing the officers table</h2>
<p>We take the same tack for the officers table.</p>
</div> </div><div id="code-16" class="cell-container " data-astro-cid-wxiprx5h> <div class="code-output-container space-y-1" data-astro-cid-wxiprx5h> <!-- Code Block --> <div class="code-section" data-astro-cid-wxiprx5h> <div class="bg-gray-900 text-gray-100 p-4 relative" data-astro-cid-wxiprx5h> <button class="copy-btn absolute top-2 right-2 px-2 py-1 text-xs bg-gray-800 hover:bg-gray-700 text-gray-300 hover:text-white rounded transition-colors cursor-pointer flex items-center gap-1" onclick="copyCode(this)" data-code="table_area = (
    section
    .find_all('text:contains(Officer #)')
    .right(include_source=True)
    .merge()
    .expand(top=5, bottom=7)
)

guides = Guides(table)
guides.vertical.from_lines(n=8)

(
  table
  .extract_table(verticals=guides.vertical)
  .to_df(header=['Name', 'ID No.', 'Rank', 'Division', 'Officer Disposition', 'Action Taken', 'Body Cam'])
)" data-astro-cid-wxiprx5h> <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" data-astro-cid-wxiprx5h> <rect x="9" y="9" width="13" height="13" rx="2" ry="2" data-astro-cid-wxiprx5h></rect> <path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1" data-astro-cid-wxiprx5h></path> </svg> <span data-astro-cid-wxiprx5h>Copy</span> </button>   <pre class="text-base overflow-x-auto" data-astro-cid-wxiprx5h><code class="language-{cell.type === 'bash' ? 'bash' : 'python'}" data-astro-cid-wxiprx5h>table_area <span class="token operator">=</span> <span class="token punctuation">(</span>
    section
    <span class="token punctuation">.</span>find_all<span class="token punctuation">(</span><span class="token string">'text:contains(Officer #)'</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span>right<span class="token punctuation">(</span>include_source<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span>merge<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span>expand<span class="token punctuation">(</span>top<span class="token operator">=</span><span class="token number">5</span><span class="token punctuation">,</span> bottom<span class="token operator">=</span><span class="token number">7</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span>

guides <span class="token operator">=</span> Guides<span class="token punctuation">(</span>table<span class="token punctuation">)</span>
guides<span class="token punctuation">.</span>vertical<span class="token punctuation">.</span>from_lines<span class="token punctuation">(</span>n<span class="token operator">=</span><span class="token number">8</span><span class="token punctuation">)</span>

<span class="token punctuation">(</span>
  table
  <span class="token punctuation">.</span>extract_table<span class="token punctuation">(</span>verticals<span class="token operator">=</span>guides<span class="token punctuation">.</span>vertical<span class="token punctuation">)</span>
  <span class="token punctuation">.</span>to_df<span class="token punctuation">(</span>header<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'Name'</span><span class="token punctuation">,</span> <span class="token string">'ID No.'</span><span class="token punctuation">,</span> <span class="token string">'Rank'</span><span class="token punctuation">,</span> <span class="token string">'Division'</span><span class="token punctuation">,</span> <span class="token string">'Officer Disposition'</span><span class="token punctuation">,</span> <span class="token string">'Action Taken'</span><span class="token punctuation">,</span> <span class="token string">'Body Cam'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span></code></pre> </div> </div> <!-- Output --> <div class="output-section" data-astro-cid-wxiprx5h> <div class="bg-gray-50" data-astro-cid-wxiprx5h> <div class="p-4 font-mono text-base" data-astro-cid-wxiprx5h> <div class="text-xs text-gray-500 mb-2 uppercase tracking-wider" data-astro-cid-wxiprx5h>Output</div> <pre class="whitespace-pre-wrap text-gray-700" data-astro-cid-wxiprx5h>[DEBUG] Executing code: table_area = section.find_all(&#39;text:contains(Officer #)&#39;).right(include_source=True).merge().expand(...
[DEBUG] Evaluating expression: table.extract_table(verticals=guides.vertical).to_df(header=[&#39;Name&#39;, &#39;ID No.&#39;, &#39;Rank&#39;, &#39;Division&#39;, &#39;...
</pre> </div> <div class="p-4" data-astro-cid-wxiprx5h>  <div class="overflow-x-auto dataframe-container prose prose-sm max-w-none" data-astro-cid-wxiprx5h><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Name</th>
      <th>ID No.</th>
      <th>Rank</th>
      <th>Division</th>
      <th>Officer Disposition</th>
      <th>Action Taken</th>
      <th>Body Cam</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>7.2.1</td>
      <td>Affirmatively Promoting a Positive Public I</td>
      <td>&lt;NA&gt;</td>
      <td>Non-Sustained</td>
      <td>&lt;NA&gt;</td>
      <td>(a</td>
      <td>)</td>
    </tr>
    <tr>
      <th>1</th>
      <td>7.2.3</td>
      <td>Observe Criminal Civil Laws</td>
      <td>&lt;NA&gt;</td>
      <td>Non-Sustained</td>
      <td>&lt;NA&gt;</td>
      <td>(a</td>
      <td>)</td>
    </tr>
    <tr>
      <th>2</th>
      <td>7.2.4</td>
      <td>Dishonesty or Untruthfulness</td>
      <td>&lt;NA&gt;</td>
      <td>Non-Sustained</td>
      <td>&lt;NA&gt;</td>
      <td>(a</td>
      <td>)</td>
    </tr>
    <tr>
      <th>3</th>
      <td>7.2.5</td>
      <td>Display Competent Performance</td>
      <td>&lt;NA&gt;</td>
      <td>Non-Sustained</td>
      <td>&lt;NA&gt;</td>
      <td>(a</td>
      <td>)</td>
    </tr>
  </tbody>
</table>
</div></div>  </div>   </div> </div> </div> </div><div class="cell-container markdown-cell" data-astro-cid-wxiprx5h> <div class="prose prose-lg max-w-none prose-headings:text-gray-900 prose-h1:text-3xl prose-h2:text-2xl prose-h3:text-xl" data-astro-cid-wxiprx5h><p>A nice #todo for me is to integrate this into <code>.extract_table</code>. Something like <code>.extract_table(columns=4)</code> would look nice, no?</p>
<h2>Combining all of the data in one CSV</h2>
<p>First we can pop through each section and extract the information we&#39;re looking for. I added a little expansion for the Date Assigned/Completed pieces as the dates are sometimes a little longer than the header.</p>
</div> </div><div id="code-17" class="cell-container " data-astro-cid-wxiprx5h> <div class="code-output-container space-y-1" data-astro-cid-wxiprx5h> <!-- Code Block --> <div class="code-section" data-astro-cid-wxiprx5h> <div class="bg-gray-900 text-gray-100 p-4 relative" data-astro-cid-wxiprx5h> <button class="copy-btn absolute top-2 right-2 px-2 py-1 text-xs bg-gray-800 hover:bg-gray-700 text-gray-300 hover:text-white rounded transition-colors cursor-pointer flex items-center gap-1" onclick="copyCode(this)" data-code="rows = []
for section in sections:
    complainant = section.find(&#34;text:contains(Complainant)&#34;).right(until='text')
    dob = section.find(&#34;text:contains(DOB)&#34;).right(until='text')
    address = section.find(&#34;text:contains(Address)&#34;).right(until='text')
    gender = section.find(&#34;text:contains(Gender)&#34;).right(until='text')
    phone = section.find(&#34;text:contains(H Phone)&#34;).right(until='text')
    investigator = (
        section
        .find(&#34;text:contains(Investigator)&#34;)
        .below(until='text', width='element')
        .find('text', overlap='partial')
    )
    number = (
        section
        .find(&#34;text:contains(Number)&#34;)
        .below(until='text', width='element')
        .find('text', overlap='partial')
    )
    date_assigned = (
      section
      .find('text:contains(Date Assigned)')
      .below(width='element')
      .expand(left=5, right=5)
      .find('text')
    )
    completed = (
      section
      .find('text:contains(Completed)')
      .below(width='element')
      .expand(left=5, right=5)
      .find('text')
    )
    recorded = (
      section
      .find('text:contains(Recorded)')
      .below(until='text', width='element')
      .expand(left=5, right=5)
    )
    
    row = {}
    row['complainant'] = complainant.extract_text()
    row['investigator'] = investigator.extract_text()
    row['number'] = number.extract_text()
    row['dob'] = dob.extract_text()
    row['address'] = address.extract_text()
    row['gender'] = gender.extract_text()
    row['phone'] = phone.extract_text()
    row['date_assigned'] = date_assigned.extract_text()
    row['completed'] = completed.extract_text()
    row['recorded'] = recorded.extract_text()
    rows.append(row)

print(&#34;We found&#34;, len(rows), &#34;rows&#34;)" data-astro-cid-wxiprx5h> <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" data-astro-cid-wxiprx5h> <rect x="9" y="9" width="13" height="13" rx="2" ry="2" data-astro-cid-wxiprx5h></rect> <path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1" data-astro-cid-wxiprx5h></path> </svg> <span data-astro-cid-wxiprx5h>Copy</span> </button>   <pre class="text-base overflow-x-auto" data-astro-cid-wxiprx5h><code class="language-{cell.type === 'bash' ? 'bash' : 'python'}" data-astro-cid-wxiprx5h>rows <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
<span class="token keyword">for</span> section <span class="token keyword">in</span> sections<span class="token punctuation">:</span>
    complainant <span class="token operator">=</span> section<span class="token punctuation">.</span>find<span class="token punctuation">(</span><span class="token string">"text:contains(Complainant)"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>right<span class="token punctuation">(</span>until<span class="token operator">=</span><span class="token string">'text'</span><span class="token punctuation">)</span>
    dob <span class="token operator">=</span> section<span class="token punctuation">.</span>find<span class="token punctuation">(</span><span class="token string">"text:contains(DOB)"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>right<span class="token punctuation">(</span>until<span class="token operator">=</span><span class="token string">'text'</span><span class="token punctuation">)</span>
    address <span class="token operator">=</span> section<span class="token punctuation">.</span>find<span class="token punctuation">(</span><span class="token string">"text:contains(Address)"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>right<span class="token punctuation">(</span>until<span class="token operator">=</span><span class="token string">'text'</span><span class="token punctuation">)</span>
    gender <span class="token operator">=</span> section<span class="token punctuation">.</span>find<span class="token punctuation">(</span><span class="token string">"text:contains(Gender)"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>right<span class="token punctuation">(</span>until<span class="token operator">=</span><span class="token string">'text'</span><span class="token punctuation">)</span>
    phone <span class="token operator">=</span> section<span class="token punctuation">.</span>find<span class="token punctuation">(</span><span class="token string">"text:contains(H Phone)"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>right<span class="token punctuation">(</span>until<span class="token operator">=</span><span class="token string">'text'</span><span class="token punctuation">)</span>
    investigator <span class="token operator">=</span> <span class="token punctuation">(</span>
        section
        <span class="token punctuation">.</span>find<span class="token punctuation">(</span><span class="token string">"text:contains(Investigator)"</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span>below<span class="token punctuation">(</span>until<span class="token operator">=</span><span class="token string">'text'</span><span class="token punctuation">,</span> width<span class="token operator">=</span><span class="token string">'element'</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span>find<span class="token punctuation">(</span><span class="token string">'text'</span><span class="token punctuation">,</span> overlap<span class="token operator">=</span><span class="token string">'partial'</span><span class="token punctuation">)</span>
    <span class="token punctuation">)</span>
    number <span class="token operator">=</span> <span class="token punctuation">(</span>
        section
        <span class="token punctuation">.</span>find<span class="token punctuation">(</span><span class="token string">"text:contains(Number)"</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span>below<span class="token punctuation">(</span>until<span class="token operator">=</span><span class="token string">'text'</span><span class="token punctuation">,</span> width<span class="token operator">=</span><span class="token string">'element'</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span>find<span class="token punctuation">(</span><span class="token string">'text'</span><span class="token punctuation">,</span> overlap<span class="token operator">=</span><span class="token string">'partial'</span><span class="token punctuation">)</span>
    <span class="token punctuation">)</span>
    date_assigned <span class="token operator">=</span> <span class="token punctuation">(</span>
      section
      <span class="token punctuation">.</span>find<span class="token punctuation">(</span><span class="token string">'text:contains(Date Assigned)'</span><span class="token punctuation">)</span>
      <span class="token punctuation">.</span>below<span class="token punctuation">(</span>width<span class="token operator">=</span><span class="token string">'element'</span><span class="token punctuation">)</span>
      <span class="token punctuation">.</span>expand<span class="token punctuation">(</span>left<span class="token operator">=</span><span class="token number">5</span><span class="token punctuation">,</span> right<span class="token operator">=</span><span class="token number">5</span><span class="token punctuation">)</span>
      <span class="token punctuation">.</span>find<span class="token punctuation">(</span><span class="token string">'text'</span><span class="token punctuation">)</span>
    <span class="token punctuation">)</span>
    completed <span class="token operator">=</span> <span class="token punctuation">(</span>
      section
      <span class="token punctuation">.</span>find<span class="token punctuation">(</span><span class="token string">'text:contains(Completed)'</span><span class="token punctuation">)</span>
      <span class="token punctuation">.</span>below<span class="token punctuation">(</span>width<span class="token operator">=</span><span class="token string">'element'</span><span class="token punctuation">)</span>
      <span class="token punctuation">.</span>expand<span class="token punctuation">(</span>left<span class="token operator">=</span><span class="token number">5</span><span class="token punctuation">,</span> right<span class="token operator">=</span><span class="token number">5</span><span class="token punctuation">)</span>
      <span class="token punctuation">.</span>find<span class="token punctuation">(</span><span class="token string">'text'</span><span class="token punctuation">)</span>
    <span class="token punctuation">)</span>
    recorded <span class="token operator">=</span> <span class="token punctuation">(</span>
      section
      <span class="token punctuation">.</span>find<span class="token punctuation">(</span><span class="token string">'text:contains(Recorded)'</span><span class="token punctuation">)</span>
      <span class="token punctuation">.</span>below<span class="token punctuation">(</span>until<span class="token operator">=</span><span class="token string">'text'</span><span class="token punctuation">,</span> width<span class="token operator">=</span><span class="token string">'element'</span><span class="token punctuation">)</span>
      <span class="token punctuation">.</span>expand<span class="token punctuation">(</span>left<span class="token operator">=</span><span class="token number">5</span><span class="token punctuation">,</span> right<span class="token operator">=</span><span class="token number">5</span><span class="token punctuation">)</span>
    <span class="token punctuation">)</span>
    
    row <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
    row<span class="token punctuation">[</span><span class="token string">'complainant'</span><span class="token punctuation">]</span> <span class="token operator">=</span> complainant<span class="token punctuation">.</span>extract_text<span class="token punctuation">(</span><span class="token punctuation">)</span>
    row<span class="token punctuation">[</span><span class="token string">'investigator'</span><span class="token punctuation">]</span> <span class="token operator">=</span> investigator<span class="token punctuation">.</span>extract_text<span class="token punctuation">(</span><span class="token punctuation">)</span>
    row<span class="token punctuation">[</span><span class="token string">'number'</span><span class="token punctuation">]</span> <span class="token operator">=</span> number<span class="token punctuation">.</span>extract_text<span class="token punctuation">(</span><span class="token punctuation">)</span>
    row<span class="token punctuation">[</span><span class="token string">'dob'</span><span class="token punctuation">]</span> <span class="token operator">=</span> dob<span class="token punctuation">.</span>extract_text<span class="token punctuation">(</span><span class="token punctuation">)</span>
    row<span class="token punctuation">[</span><span class="token string">'address'</span><span class="token punctuation">]</span> <span class="token operator">=</span> address<span class="token punctuation">.</span>extract_text<span class="token punctuation">(</span><span class="token punctuation">)</span>
    row<span class="token punctuation">[</span><span class="token string">'gender'</span><span class="token punctuation">]</span> <span class="token operator">=</span> gender<span class="token punctuation">.</span>extract_text<span class="token punctuation">(</span><span class="token punctuation">)</span>
    row<span class="token punctuation">[</span><span class="token string">'phone'</span><span class="token punctuation">]</span> <span class="token operator">=</span> phone<span class="token punctuation">.</span>extract_text<span class="token punctuation">(</span><span class="token punctuation">)</span>
    row<span class="token punctuation">[</span><span class="token string">'date_assigned'</span><span class="token punctuation">]</span> <span class="token operator">=</span> date_assigned<span class="token punctuation">.</span>extract_text<span class="token punctuation">(</span><span class="token punctuation">)</span>
    row<span class="token punctuation">[</span><span class="token string">'completed'</span><span class="token punctuation">]</span> <span class="token operator">=</span> completed<span class="token punctuation">.</span>extract_text<span class="token punctuation">(</span><span class="token punctuation">)</span>
    row<span class="token punctuation">[</span><span class="token string">'recorded'</span><span class="token punctuation">]</span> <span class="token operator">=</span> recorded<span class="token punctuation">.</span>extract_text<span class="token punctuation">(</span><span class="token punctuation">)</span>
    rows<span class="token punctuation">.</span>append<span class="token punctuation">(</span>row<span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"We found"</span><span class="token punctuation">,</span> <span class="token builtin">len</span><span class="token punctuation">(</span>rows<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">"rows"</span><span class="token punctuation">)</span></code></pre> </div> </div> <!-- Output --> <div class="output-section" data-astro-cid-wxiprx5h> <div class="bg-gray-50" data-astro-cid-wxiprx5h> <div class="p-4 font-mono text-base" data-astro-cid-wxiprx5h> <div class="text-xs text-gray-500 mb-2 uppercase tracking-wider" data-astro-cid-wxiprx5h>Output</div> <pre class="whitespace-pre-wrap text-gray-700" data-astro-cid-wxiprx5h>[DEBUG] Executing code: rows = []
for section in sections:
    complainant = section.find(&#39;text:contains(Complainant)&#39;).righ...
[DEBUG] Evaluating expression: print(&#39;We found&#39;, len(rows), &#39;rows&#39;)...
We found 16 rows
</pre> </div>    </div> </div> </div> </div><div class="cell-container markdown-cell" data-astro-cid-wxiprx5h> <div class="prose prose-lg max-w-none prose-headings:text-gray-900 prose-h1:text-3xl prose-h2:text-2xl prose-h3:text-xl" data-astro-cid-wxiprx5h><p>Now we can push it into pandas without a problem!</p>
</div> </div><div id="code-18" class="cell-container " data-astro-cid-wxiprx5h> <div class="code-output-container space-y-1" data-astro-cid-wxiprx5h> <!-- Code Block --> <div class="code-section" data-astro-cid-wxiprx5h> <div class="bg-gray-900 text-gray-100 p-4 relative" data-astro-cid-wxiprx5h> <button class="copy-btn absolute top-2 right-2 px-2 py-1 text-xs bg-gray-800 hover:bg-gray-700 text-gray-300 hover:text-white rounded transition-colors cursor-pointer flex items-center gap-1" onclick="copyCode(this)" data-code="import pandas as pd

df = pd.DataFrame(rows)
df" data-astro-cid-wxiprx5h> <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" data-astro-cid-wxiprx5h> <rect x="9" y="9" width="13" height="13" rx="2" ry="2" data-astro-cid-wxiprx5h></rect> <path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1" data-astro-cid-wxiprx5h></path> </svg> <span data-astro-cid-wxiprx5h>Copy</span> </button>   <pre class="text-base overflow-x-auto" data-astro-cid-wxiprx5h><code class="language-{cell.type === 'bash' ? 'bash' : 'python'}" data-astro-cid-wxiprx5h><span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd

df <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span>rows<span class="token punctuation">)</span>
df</code></pre> </div> </div> <!-- Output --> <div class="output-section" data-astro-cid-wxiprx5h> <div class="bg-gray-50" data-astro-cid-wxiprx5h> <div class="p-4 font-mono text-base" data-astro-cid-wxiprx5h> <div class="text-xs text-gray-500 mb-2 uppercase tracking-wider" data-astro-cid-wxiprx5h>Output</div> <pre class="whitespace-pre-wrap text-gray-700" data-astro-cid-wxiprx5h>[DEBUG] Executing code: import pandas as pd
df = pd.DataFrame(rows)...
[DEBUG] Evaluating expression: df...
</pre> </div> <div class="p-4" data-astro-cid-wxiprx5h>  <div class="overflow-x-auto dataframe-container prose prose-sm max-w-none" data-astro-cid-wxiprx5h><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>complainant</th>
      <th>investigator</th>
      <th>number</th>
      <th>dob</th>
      <th>address</th>
      <th>gender</th>
      <th>phone</th>
      <th>date_assigned</th>
      <th>completed</th>
      <th>recorded</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Undersheriff</td>
      <td>Parker, Scott (Sgt)</td>
      <td>11-004 IA</td>
      <td>Gender:</td>
      <td>NOT STATED ?? UNK</td>
      <td>Address:</td>
      <td></td>
      <td>3/9/2011</td>
      <td>4/27/2011</td>
      <td>No\nN/A</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Nygaard, Karen</td>
      <td>Ball, Michael</td>
      <td>10-001 IAC</td>
      <td>Gender:</td>
      <td>3025 Oakes Ave, Everett WA 98201</td>
      <td>Female</td>
      <td></td>
      <td>1/27/2010</td>
      <td>2/11/2010</td>
      <td>No\nN/A</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Shavlik, Lori</td>
      <td>Barnett, Robert (Sgt)</td>
      <td>16-001 IA</td>
      <td>4/25/1969</td>
      <td>Not Stated WA Unk</td>
      <td>Female</td>
      <td>(425) 345-4959</td>
      <td>1/6/2016</td>
      <td>3/3/2016</td>
      <td>No\nN/A</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Shavlik, Lori D</td>
      <td>Heitzman, Dave (Sgt)</td>
      <td>16-002 IA</td>
      <td>4/25/1969</td>
      <td>Not Stated WA Unk</td>
      <td>Female</td>
      <td>(425) 345-4959</td>
      <td>1/6/2016</td>
      <td>2/29/2016</td>
      <td>No\nN/A</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Lang, Kathi (Lt)</td>
      <td>Johnson, Susanna</td>
      <td>10-003IA</td>
      <td>Gender:</td>
      <td>SCSO, Everett WA 98201</td>
      <td>Female</td>
      <td></td>
      <td>3/5/2010</td>
      <td>5/10/2010</td>
      <td>No\nN/A</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Undersheriff Tom Davis</td>
      <td>Speyer, Brent (Lt)</td>
      <td>10-003 IAC</td>
      <td>Gender:</td>
      <td>3025 Oakes Ave., Everett WA 98201</td>
      <td>Male</td>
      <td></td>
      <td>4/9/2010</td>
      <td>8/19/2010</td>
      <td>No\nN/A</td>
    </tr>
    <tr>
      <th>6</th>
      <td>Hover, Rebecca</td>
      <td>Johnson, Susanna (Sgt)</td>
      <td>10-005IA</td>
      <td>Gender:</td>
      <td>SCSO, Everett WA 98201</td>
      <td>Female</td>
      <td></td>
      <td>4/15/2010</td>
      <td>5/18/2010</td>
      <td>No\nN/A</td>
    </tr>
    <tr>
      <th>7</th>
      <td>Ball, Michael</td>
      <td>Ball, Michael (Sgt)</td>
      <td>10-013 IAC</td>
      <td>Gender:</td>
      <td>3025 Oakes Ave, Everett WA 98021</td>
      <td>Male</td>
      <td></td>
      <td>12/7/2010</td>
      <td>2/8/2011</td>
      <td>No\nN/A</td>
    </tr>
    <tr>
      <th>8</th>
      <td>Baird, Mark</td>
      <td>Ball, Michael</td>
      <td>10-004 IAC</td>
      <td>Gender:</td>
      <td>3000 Rockefeller Ave, Everett WA 98201</td>
      <td>Male</td>
      <td></td>
      <td>4/29/2010</td>
      <td>9/14/2010</td>
      <td>No\nN/A</td>
    </tr>
    <tr>
      <th>9</th>
      <td>Saleem, Haroon (Mayor)</td>
      <td>Rinta, Gregg (Sgt)</td>
      <td>10-006IA</td>
      <td>Gender:</td>
      <td>City Hall, Granite Falls WA 98252</td>
      <td>Male</td>
      <td></td>
      <td>4/23/2010</td>
      <td>8/31/2010</td>
      <td>No\nN/A</td>
    </tr>
    <tr>
      <th>10</th>
      <td>Lt. Rick Hawkins(Acting Chief)</td>
      <td>Link, Norman (Sgt)</td>
      <td>10-010 IA</td>
      <td>Gender:</td>
      <td>Granite Falls PD, Granite Falls WA 98252</td>
      <td>Address:</td>
      <td></td>
      <td>8/10/2010</td>
      <td>8/31/2010</td>
      <td>No\nN/A</td>
    </tr>
    <tr>
      <th>11</th>
      <td>05A Jail -</td>
      <td>Ball, Michael</td>
      <td>10-005 IAC</td>
      <td>Gender:</td>
      <td>Jail Inmate, Everett WA 98021</td>
      <td>Male</td>
      <td></td>
      <td>5/25/2010</td>
      <td>6/24/2010</td>
      <td>No\nN/A</td>
    </tr>
    <tr>
      <th>12</th>
      <td>05A Jail -</td>
      <td>Ball, Michael</td>
      <td>10-007 IAC</td>
      <td>Gender:</td>
      <td>Jail Inmate, Everett WA 98201</td>
      <td>Male</td>
      <td></td>
      <td>7/7/2010</td>
      <td>7/28/2010</td>
      <td>No\nN/A</td>
    </tr>
    <tr>
      <th>13</th>
      <td>Young, Brian</td>
      <td>Parker, Scott (Sgt)</td>
      <td>11-002 IA</td>
      <td>Gender:</td>
      <td>16626 6 Ave W, Lynnwood WA UNK</td>
      <td>Address:</td>
      <td>(206) 909-3150</td>
      <td>5/26/2011</td>
      <td>6/29/2011</td>
      <td>No\nN/A</td>
    </tr>
    <tr>
      <th>14</th>
      <td>McDonald, Steve (Sgt)</td>
      <td>Johnson, Susanna (Lt)</td>
      <td>10-007IA</td>
      <td>Gender:</td>
      <td>SCSO, Everett WA 98201</td>
      <td>Male</td>
      <td></td>
      <td>6/15/2010</td>
      <td>7/16/2010</td>
      <td>No\nN/A</td>
    </tr>
    <tr>
      <th>15</th>
      <td>Tennison, Steven</td>
      <td>Ball, Michael</td>
      <td>10-006 IAC</td>
      <td>Gender:</td>
      <td>3025 Oakes Ave, Everett WA 98021</td>
      <td>Male</td>
      <td></td>
      <td>6/25/2010</td>
      <td>10/14/2010</td>
      <td>No\nN/A</td>
    </tr>
  </tbody>
</table>
</div></div>  </div>   </div> </div> </div> </div><div class="cell-container markdown-cell" data-astro-cid-wxiprx5h> <div class="prose prose-lg max-w-none prose-headings:text-gray-900 prose-h1:text-3xl prose-h2:text-2xl prose-h3:text-xl" data-astro-cid-wxiprx5h><h2>Saving the tables as combined CSVs</h2>
<p>Usually when you have a number of similar tables in one PDF, you don&#39;t want to make a bunch of different CSV files, you want to <strong>put them all into one CSV</strong>.</p>
<p>We&#39;ll do that by looping through each section like we did before, but we&#39;ll also add a new column to our data: the <code>number</code></p>
</div> </div><div id="code-19" class="cell-container " data-astro-cid-wxiprx5h> <div class="code-output-container space-y-1" data-astro-cid-wxiprx5h> <!-- Code Block --> <div class="code-section" data-astro-cid-wxiprx5h> <div class="bg-gray-900 text-gray-100 p-4 relative" data-astro-cid-wxiprx5h> <button class="copy-btn absolute top-2 right-2 px-2 py-1 text-xs bg-gray-800 hover:bg-gray-700 text-gray-300 hover:text-white rounded transition-colors cursor-pointer flex items-center gap-1" onclick="copyCode(this)" data-code="import pandas as pd

officer_dfs = []
for section in sections:
    # Not every section has officers, exit
    # early if Officer number not mentioned
    if 'Officer #' not in section.extract_text():
      continue

    # Grab the case number
    case_number = (
        section
        .find(&#34;text:contains(Number)&#34;)
        .below(until='text', width='element')
        .find('text', overlap='partial')
        .extract_text()
    )

    # Grab the table area
    table = (
        section
        .find_all('text:contains(Officer #)')
        .right(include_source=True)
        .merge()
        .expand(top=3, bottom=6)
    )
    
    # Use the guides to extract the table
    guides = Guides(table)
    guides.vertical.from_lines(n=8)
    columns = ['Name', 'ID No.', 'Rank', 'Division', 'Officer Disposition', 'Action Taken', 'Body Cam']
    officer_df = (
      table
      .extract_table(verticals=guides.vertical)
      .to_df(header=columns)
    )

    # Add to your list
    officer_df['case_number'] = case_number
    officer_dfs.append(officer_df)

# Combine the dataframes
print(&#34;Combining&#34;, len(officer_dfs), &#34;officer dataframes&#34;)
df = pd.concat(officer_dfs, ignore_index=True)
df.head()" data-astro-cid-wxiprx5h> <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" data-astro-cid-wxiprx5h> <rect x="9" y="9" width="13" height="13" rx="2" ry="2" data-astro-cid-wxiprx5h></rect> <path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1" data-astro-cid-wxiprx5h></path> </svg> <span data-astro-cid-wxiprx5h>Copy</span> </button>   <pre class="text-base overflow-x-auto" data-astro-cid-wxiprx5h><code class="language-{cell.type === 'bash' ? 'bash' : 'python'}" data-astro-cid-wxiprx5h><span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd

officer_dfs <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
<span class="token keyword">for</span> section <span class="token keyword">in</span> sections<span class="token punctuation">:</span>
    <span class="token comment"># Not every section has officers, exit</span>
    <span class="token comment"># early if Officer number not mentioned</span>
    <span class="token keyword">if</span> <span class="token string">'Officer #'</span> <span class="token keyword">not</span> <span class="token keyword">in</span> section<span class="token punctuation">.</span>extract_text<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
      <span class="token keyword">continue</span>

    <span class="token comment"># Grab the case number</span>
    case_number <span class="token operator">=</span> <span class="token punctuation">(</span>
        section
        <span class="token punctuation">.</span>find<span class="token punctuation">(</span><span class="token string">"text:contains(Number)"</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span>below<span class="token punctuation">(</span>until<span class="token operator">=</span><span class="token string">'text'</span><span class="token punctuation">,</span> width<span class="token operator">=</span><span class="token string">'element'</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span>find<span class="token punctuation">(</span><span class="token string">'text'</span><span class="token punctuation">,</span> overlap<span class="token operator">=</span><span class="token string">'partial'</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span>extract_text<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">)</span>

    <span class="token comment"># Grab the table area</span>
    table <span class="token operator">=</span> <span class="token punctuation">(</span>
        section
        <span class="token punctuation">.</span>find_all<span class="token punctuation">(</span><span class="token string">'text:contains(Officer #)'</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span>right<span class="token punctuation">(</span>include_source<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span>merge<span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span>expand<span class="token punctuation">(</span>top<span class="token operator">=</span><span class="token number">3</span><span class="token punctuation">,</span> bottom<span class="token operator">=</span><span class="token number">6</span><span class="token punctuation">)</span>
    <span class="token punctuation">)</span>
    
    <span class="token comment"># Use the guides to extract the table</span>
    guides <span class="token operator">=</span> Guides<span class="token punctuation">(</span>table<span class="token punctuation">)</span>
    guides<span class="token punctuation">.</span>vertical<span class="token punctuation">.</span>from_lines<span class="token punctuation">(</span>n<span class="token operator">=</span><span class="token number">8</span><span class="token punctuation">)</span>
    columns <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'Name'</span><span class="token punctuation">,</span> <span class="token string">'ID No.'</span><span class="token punctuation">,</span> <span class="token string">'Rank'</span><span class="token punctuation">,</span> <span class="token string">'Division'</span><span class="token punctuation">,</span> <span class="token string">'Officer Disposition'</span><span class="token punctuation">,</span> <span class="token string">'Action Taken'</span><span class="token punctuation">,</span> <span class="token string">'Body Cam'</span><span class="token punctuation">]</span>
    officer_df <span class="token operator">=</span> <span class="token punctuation">(</span>
      table
      <span class="token punctuation">.</span>extract_table<span class="token punctuation">(</span>verticals<span class="token operator">=</span>guides<span class="token punctuation">.</span>vertical<span class="token punctuation">)</span>
      <span class="token punctuation">.</span>to_df<span class="token punctuation">(</span>header<span class="token operator">=</span>columns<span class="token punctuation">)</span>
    <span class="token punctuation">)</span>

    <span class="token comment"># Add to your list</span>
    officer_df<span class="token punctuation">[</span><span class="token string">'case_number'</span><span class="token punctuation">]</span> <span class="token operator">=</span> case_number
    officer_dfs<span class="token punctuation">.</span>append<span class="token punctuation">(</span>officer_df<span class="token punctuation">)</span>

<span class="token comment"># Combine the dataframes</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Combining"</span><span class="token punctuation">,</span> <span class="token builtin">len</span><span class="token punctuation">(</span>officer_dfs<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">"officer dataframes"</span><span class="token punctuation">)</span>
df <span class="token operator">=</span> pd<span class="token punctuation">.</span>concat<span class="token punctuation">(</span>officer_dfs<span class="token punctuation">,</span> ignore_index<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
df<span class="token punctuation">.</span>head<span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre> </div> </div> <!-- Output --> <div class="output-section" data-astro-cid-wxiprx5h> <div class="bg-gray-50" data-astro-cid-wxiprx5h> <div class="p-4 font-mono text-base" data-astro-cid-wxiprx5h> <div class="text-xs text-gray-500 mb-2 uppercase tracking-wider" data-astro-cid-wxiprx5h>Output</div> <pre class="whitespace-pre-wrap text-gray-700" data-astro-cid-wxiprx5h>[DEBUG] Executing code: import pandas as pd
officer_dfs = []
for section in sections:
    if &#39;Officer #&#39; not in section.extr...
Combining 16 officer dataframes
[DEBUG] Evaluating expression: df.head()...
</pre> </div> <div class="p-4" data-astro-cid-wxiprx5h>  <div class="overflow-x-auto dataframe-container prose prose-sm max-w-none" data-astro-cid-wxiprx5h><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Name</th>
      <th>ID No.</th>
      <th>Rank</th>
      <th>Division</th>
      <th>Officer Disposition</th>
      <th>Action Taken</th>
      <th>Body Cam</th>
      <th>case_number</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Kunard, James C</td>
      <td>1489</td>
      <td>Deputy</td>
      <td>Sheriff</td>
      <td>Within Policy-Intenti</td>
      <td>None</td>
      <td>No</td>
      <td>11-004 IA</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Yedlin, Ira N</td>
      <td>7089</td>
      <td>ARNP</td>
      <td>Corrections</td>
      <td>Purged</td>
      <td>Termination</td>
      <td>No</td>
      <td>10-001 IAC</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Conley, Kendra D.</td>
      <td>1535</td>
      <td>Deputy</td>
      <td>Sheriff</td>
      <td>Non-Sustained (a)</td>
      <td>None</td>
      <td>No</td>
      <td>16-001 IA</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Fontenot, David</td>
      <td>1540</td>
      <td>Deputy</td>
      <td>Sheriff</td>
      <td>Non-Sustained (a)</td>
      <td>None</td>
      <td>No</td>
      <td>16-001 IA</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Bryant, Alan James</td>
      <td>1529</td>
      <td>Lieutenant</td>
      <td>Sheriff</td>
      <td>Non-Sustained (a)</td>
      <td>None</td>
      <td>No</td>
      <td>16-002 IA</td>
    </tr>
  </tbody>
</table>
</div></div>  </div>   </div> </div> </div> </div><div class="cell-container markdown-cell" data-astro-cid-wxiprx5h> <div class="prose prose-lg max-w-none prose-headings:text-gray-900 prose-h1:text-3xl prose-h2:text-2xl prose-h3:text-xl" data-astro-cid-wxiprx5h><p>Repeat the same thing for complaints (just changing <code>n=8</code> to <code>n=4</code>) and you&#39;ll be good to go!</p>
</div> </div> </div> </div> </div> </div> <script type="module">document.addEventListener("DOMContentLoaded",()=>{document.querySelectorAll(".tab-group-wrapper").forEach(t=>{const a=t.querySelectorAll(".tab-button"),c=t.querySelectorAll(".tab-panel");a.forEach((r,s)=>{r.addEventListener("click",()=>{a.forEach(e=>e.classList.remove("active")),c.forEach(e=>e.classList.remove("active")),r.classList.add("active"),c[s].classList.add("active")})})})});</script> <script type="module">function t(){const n=window.location.hash;if(!n)return;const c=decodeURIComponent(n.substring(1)),s=document.querySelectorAll(".code-section pre code");for(const o of s)if((o.textContent||"").includes(c)){const e=o.closest(".cell-container");if(e){e.scrollIntoView({behavior:"smooth",block:"center"}),e.style.background="#fef3c7",setTimeout(()=>{e.style.transition="background 1s ease",e.style.background=""},1e3);break}}}window.addEventListener("load",t);window.addEventListener("hashchange",t);</script> <script type="module">window.copyCode=function(e){const c=e.getAttribute("data-code");navigator.clipboard.writeText(c).then(()=>{const t=e.querySelector("span"),o=t.textContent;t.textContent="Copied!",setTimeout(()=>{t.textContent=o},2e3)}).catch(t=>{console.error("Failed to copy:",t)})};let r=localStorage.getItem("columnView")==="true",s=!1;r&&document.querySelector(".cells-container")?.classList.add("column-view");const n=document.createElement("div");n.style.cssText="position: fixed; bottom: 20px; right: 20px; background: black; color: white; padding: 8px 12px; border-radius: 4px; font-size: 12px; opacity: 0; transition: opacity 0.2s; z-index: 9999;";document.body.appendChild(n);function d(e){n.textContent=e,n.style.opacity="0.8",setTimeout(()=>{n.style.opacity="0"},1500)}document.addEventListener("keydown",e=>{document.querySelector(".cells-container"),document.querySelectorAll(".result-image"),e.key==="r"&&i()});setTimeout(()=>{d("R: toggle PDF")},1e3);function i(){const e=document.querySelector(".pdf-view-btn"),c=document.querySelector(".pdf-sidebar-content"),t=document.querySelector(".content-wrapper"),o=document.querySelector(".pdf-embed");if(s)e.style.display="block",c.style.display="none",t.classList.remove("show-pdf"),s=!1,d("PDF: OFF");else{if(e.style.display="none",c.style.display="block",t.classList.add("show-pdf"),!o.src){const l=o.dataset.pdfUrl;o.src=l+"#toolbar=1&navpanes=0&scrollbar=1"}s=!0,d("PDF: ON")}}const a=document.querySelector(".pdf-view-btn");a?.addEventListener("click",i);const p=document.querySelector(".pdf-close-btn");p?.addEventListener("click",i);</script> <script type="module" src="/_astro/ImageLightbox.astro_astro_type_script_index_0_lang.Cx4c9KCn.js"></script> <footer class="site-footer" data-astro-cid-sz7xmlte> <div class="footer-container" data-astro-cid-sz7xmlte> <div class="footer-content" data-astro-cid-sz7xmlte> <div class="footer-section" data-astro-cid-sz7xmlte> <h3 data-astro-cid-sz7xmlte>Bad PDFs</h3> <p data-astro-cid-sz7xmlte>Real-world successfully extracting data from bad, bad pdfs.</p> <div class="footer-links" data-astro-cid-sz7xmlte> <a href="https://github.com/jsoma/natural-pdf" target="_blank" rel="noopener noreferrer" data-astro-cid-sz7xmlte> <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor" data-astro-cid-sz7xmlte> <path d="M12 0c-6.626 0-12 5.373-12 12 0 5.302 3.438 9.8 8.207 11.387.599.111.793-.261.793-.577v-2.234c-3.338.726-4.033-1.416-4.033-1.416-.546-1.387-1.333-1.756-1.333-1.756-1.089-.745.083-.729.083-.729 1.205.084 1.839 1.237 1.839 1.237 1.07 1.834 2.807 1.304 3.492.997.107-.775.418-1.305.762-1.604-2.665-.305-5.467-1.334-5.467-5.931 0-1.311.469-2.381 1.236-3.221-.124-.303-.535-1.524.117-3.176 0 0 1.008-.322 3.301 1.23.957-.266 1.983-.399 3.003-.404 1.02.005 2.047.138 3.006.404 2.291-1.552 3.297-1.23 3.297-1.23.653 1.653.242 2.874.118 3.176.77.84 1.235 1.911 1.235 3.221 0 4.609-2.807 5.624-5.479 5.921.43.372.823 1.102.823 2.222v3.293c0 .319.192.694.801.576 4.765-1.589 8.199-6.086 8.199-11.386 0-6.627-5.373-12-12-12z" data-astro-cid-sz7xmlte></path> </svg>
GitHub
</a> </div> </div> <div class="footer-section" data-astro-cid-sz7xmlte> <h3 data-astro-cid-sz7xmlte>Resources</h3> <ul data-astro-cid-sz7xmlte> <li data-astro-cid-sz7xmlte><a href="https://jsoma.github.io/natural-pdf/" data-astro-cid-sz7xmlte>natural-pdf Documentation</a></li> <li data-astro-cid-sz7xmlte><a href="/methods/" data-astro-cid-sz7xmlte>All Methods Reference</a></li> <li data-astro-cid-sz7xmlte><a href="https://github.com/jsoma/natural-pdf/issues" data-astro-cid-sz7xmlte>Report an Issue</a></li> <li data-astro-cid-sz7xmlte><a href="/about/" data-astro-cid-sz7xmlte>About This Gallery</a></li> </ul> </div> <div class="footer-section" data-astro-cid-sz7xmlte> <h3 data-astro-cid-sz7xmlte>Contribute</h3> <ul data-astro-cid-sz7xmlte> <li data-astro-cid-sz7xmlte><a href="/submit/" data-astro-cid-sz7xmlte>Submit a PDF Example</a></li> <li data-astro-cid-sz7xmlte><a href="https://github.com/jsoma/badpdfs-analysis" data-astro-cid-sz7xmlte>Gallery Source Code</a></li> <li data-astro-cid-sz7xmlte><a href="https://github.com/jsoma/natural-pdf#contributing" data-astro-cid-sz7xmlte>Contributing Guide</a></li> </ul> </div> </div> <div class="footer-bottom" data-astro-cid-sz7xmlte> <p data-astro-cid-sz7xmlte>&copy; 2025 Bad PDFs. Built with <a href="https://astro.build" data-astro-cid-sz7xmlte>Astro</a> and powered by <a href="https://jsoma.github.io/natural-pdf/" data-astro-cid-sz7xmlte>natural-pdf</a>.</p> </div> </div> </footer>   </body></html>