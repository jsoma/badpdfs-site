<!DOCTYPE html><html lang="en"> <head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Search | bad pdfs</title><meta name="description" content="Search for PDFs and methods in the bad pdfs gallery"><link rel="stylesheet" href="/_astro/about.K2Del1EQ.css">
<link rel="stylesheet" href="/_astro/about.DqOHNfsy.css">
<style>.search-page{min-height:calc(100vh - 80px)}.container{max-width:1280px;margin:0 auto;padding:2rem}.page-header{text-align:center;margin-bottom:3rem}.page-header h1{font-size:2.5rem;font-weight:700;margin:0 0 .5rem;background:linear-gradient(135deg,var(--color-gradient-start) 0%,var(--color-gradient-end) 100%);-webkit-background-clip:text;-webkit-text-fill-color:transparent;background-clip:text}.page-header p{font-size:1.125rem;color:var(--color-text-muted);margin:0}.search-results-container{margin-top:2rem}.loading,.empty-state{text-align:center;color:var(--color-text-muted);padding:4rem 2rem}.empty-state p{margin:0 0 .5rem;font-size:1.125rem}.help-text{font-size:.875rem;opacity:.8}.results-section{margin-bottom:2rem}.results-section:first-child{margin-top:2rem}.results-header{font-size:1.5rem;font-weight:700;color:var(--color-primary);margin:0 0 1rem;border-top:1px solid var(--color-border);padding-top:2rem}.results-header .count{font-weight:400;color:var(--color-text-muted);font-size:1rem}.method-results{display:grid;grid-template-columns:repeat(auto-fill,minmax(300px,1fr));gap:1rem}.method-group{display:block;padding:1.25rem;background:var(--color-surface);border:1px solid var(--color-border);border-radius:.5rem;text-decoration:none;transition:all .2s ease}.method-group:hover{border-color:var(--color-primary);box-shadow:0 4px 6px -1px #0000001a,0 2px 4px -1px #0000000f;transform:translateY(-2px)}.method-header{display:flex;justify-content:space-between;align-items:center;margin-bottom:.75rem}.method-name{font-family:ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,monospace;font-size:1rem;font-weight:600;color:var(--color-text);margin:0}.method-count{font-size:.75rem;color:var(--color-text-muted);background:var(--color-background);padding:.25rem .5rem;border-radius:9999px}.method-examples{font-size:.75rem;color:var(--color-text-muted);display:flex;align-items:center;gap:.375rem;flex-wrap:wrap}.examples-label{font-weight:500}.example-name{color:var(--color-primary)}.separator{color:var(--color-border)}.more{color:var(--color-text-muted)}.pdf-results{display:grid;gap:1rem}.result-item{display:block;padding:1.25rem;background:var(--color-surface);border:1px solid var(--color-border);border-radius:.75rem;text-decoration:none;transition:all .2s ease}.result-item:hover{border-color:var(--color-primary);box-shadow:0 4px 12px #0000000d;transform:translateY(-1px)}.result-title{font-size:1.125rem;font-weight:700;color:var(--color-text);margin-bottom:.5rem}.result-description{font-size:.875rem;color:var(--color-text-muted);margin-bottom:.75rem;line-height:1.5}.result-methods{display:flex;gap:.5rem;flex-wrap:wrap;align-items:center}.more-methods{font-size:.75rem;color:var(--color-text-muted)}mark{background:var(--color-primary);color:#fff;font-weight:700;padding:.0625rem .25rem;border-radius:.1875rem}@media (max-width: 768px){.container{padding:0 1rem}.search-header h1{font-size:2rem}.search-box{flex-direction:column}.search-button{width:100%}}
</style></head> <body> <header class="site-header" data-astro-cid-3ef6ksr2> <div class="header-container" data-astro-cid-3ef6ksr2> <div class="header-left" data-astro-cid-3ef6ksr2> <a href="/" class="site-title" data-astro-cid-3ef6ksr2> <h1 data-astro-cid-3ef6ksr2>bad pdfs</h1> </a> <nav class="header-nav" data-astro-cid-3ef6ksr2> <a href="/" class data-astro-cid-3ef6ksr2>Gallery</a> <a href="/methods/" class data-astro-cid-3ef6ksr2>All Methods</a> <a href="/about/" class data-astro-cid-3ef6ksr2>About</a> <a href="https://jsoma.github.io/natural-pdf/" target="_blank" rel="noopener noreferrer" class="external" data-astro-cid-3ef6ksr2>
natural-pdf docs
<svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" data-astro-cid-3ef6ksr2> <path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6" data-astro-cid-3ef6ksr2></path> <polyline points="15 3 21 3 21 9" data-astro-cid-3ef6ksr2></polyline> <line x1="10" y1="14" x2="21" y2="3" data-astro-cid-3ef6ksr2></line> </svg> </a> </nav> </div> <div class="header-right" data-astro-cid-3ef6ksr2> <button class="dark-mode-toggle" aria-label="Toggle dark mode" data-astro-cid-tcsrer47> <svg class="sun-icon" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" data-astro-cid-tcsrer47> <circle cx="12" cy="12" r="5" data-astro-cid-tcsrer47></circle> <line x1="12" y1="1" x2="12" y2="3" data-astro-cid-tcsrer47></line> <line x1="12" y1="21" x2="12" y2="23" data-astro-cid-tcsrer47></line> <line x1="4.22" y1="4.22" x2="5.64" y2="5.64" data-astro-cid-tcsrer47></line> <line x1="18.36" y1="18.36" x2="19.78" y2="19.78" data-astro-cid-tcsrer47></line> <line x1="1" y1="12" x2="3" y2="12" data-astro-cid-tcsrer47></line> <line x1="21" y1="12" x2="23" y2="12" data-astro-cid-tcsrer47></line> <line x1="4.22" y1="19.78" x2="5.64" y2="18.36" data-astro-cid-tcsrer47></line> <line x1="18.36" y1="5.64" x2="19.78" y2="4.22" data-astro-cid-tcsrer47></line> </svg> <svg class="moon-icon" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" data-astro-cid-tcsrer47> <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z" data-astro-cid-tcsrer47></path> </svg> </button>  <script type="module">const m=document.querySelector(".dark-mode-toggle"),e=document.documentElement,r=localStorage.getItem("theme")||"light";e.setAttribute("data-theme",r);m?.addEventListener("click",()=>{const t=e.getAttribute("data-theme")==="dark"?"light":"dark";e.setAttribute("data-theme",t),localStorage.setItem("theme",t)});const a=window.matchMedia("(prefers-color-scheme: dark)");localStorage.getItem("theme")||e.setAttribute("data-theme",a.matches?"dark":"light");a.addEventListener("change",t=>{localStorage.getItem("theme")||e.setAttribute("data-theme",t.matches?"dark":"light")});</script> <!-- Pass BASE_URL to client-side JavaScript --><meta name="base-url" content="/" style="display: none;"><div class="search-wrapper" data-astro-cid-otpdt6jm> <div class="search-container" data-astro-cid-otpdt6jm> <div class="search-input-wrapper" data-astro-cid-otpdt6jm> <svg class="search-icon" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" data-astro-cid-otpdt6jm> <circle cx="11" cy="11" r="8" data-astro-cid-otpdt6jm></circle> <path d="m21 21-4.35-4.35" data-astro-cid-otpdt6jm></path> </svg> <input type="search" id="search-input" class="search-input" placeholder="Search PDFs, methods, or content..." autocomplete="off" spellcheck="false" data-astro-cid-otpdt6jm> <span class="search-shortcut" data-astro-cid-otpdt6jm>/</span> </div> <div id="search-results" class="search-results" data-astro-cid-otpdt6jm></div> </div> </div> <script type="module" src="/_astro/Search.astro_astro_type_script_index_0_lang.Bxe8LC99.js"></script>  <!-- Global styles for dynamically generated search results -->  </div> </div> </header>  <main class="search-page"> <div class="container"> <div class="page-header"> <h1>Search Results</h1>  </div> <div id="search-results-container" class="search-results-container"> <div class="empty-state"> <p>No search query provided</p> </div> </div> </div> </main> <footer class="site-footer" data-astro-cid-sz7xmlte> <div class="footer-container" data-astro-cid-sz7xmlte> <div class="footer-content" data-astro-cid-sz7xmlte> <div class="footer-section" data-astro-cid-sz7xmlte> <h3 data-astro-cid-sz7xmlte>Bad PDFs</h3> <p data-astro-cid-sz7xmlte>Real-world successfully extracting data from bad, bad pdfs.</p> <div class="footer-links" data-astro-cid-sz7xmlte> <a href="https://github.com/jsoma/natural-pdf" target="_blank" rel="noopener noreferrer" data-astro-cid-sz7xmlte> <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor" data-astro-cid-sz7xmlte> <path d="M12 0c-6.626 0-12 5.373-12 12 0 5.302 3.438 9.8 8.207 11.387.599.111.793-.261.793-.577v-2.234c-3.338.726-4.033-1.416-4.033-1.416-.546-1.387-1.333-1.756-1.333-1.756-1.089-.745.083-.729.083-.729 1.205.084 1.839 1.237 1.839 1.237 1.07 1.834 2.807 1.304 3.492.997.107-.775.418-1.305.762-1.604-2.665-.305-5.467-1.334-5.467-5.931 0-1.311.469-2.381 1.236-3.221-.124-.303-.535-1.524.117-3.176 0 0 1.008-.322 3.301 1.23.957-.266 1.983-.399 3.003-.404 1.02.005 2.047.138 3.006.404 2.291-1.552 3.297-1.23 3.297-1.23.653 1.653.242 2.874.118 3.176.77.84 1.235 1.911 1.235 3.221 0 4.609-2.807 5.624-5.479 5.921.43.372.823 1.102.823 2.222v3.293c0 .319.192.694.801.576 4.765-1.589 8.199-6.086 8.199-11.386 0-6.627-5.373-12-12-12z" data-astro-cid-sz7xmlte></path> </svg>
GitHub
</a> </div> </div> <div class="footer-section" data-astro-cid-sz7xmlte> <h3 data-astro-cid-sz7xmlte>Resources</h3> <ul data-astro-cid-sz7xmlte> <li data-astro-cid-sz7xmlte><a href="https://jsoma.github.io/natural-pdf/" data-astro-cid-sz7xmlte>natural-pdf Documentation</a></li> <li data-astro-cid-sz7xmlte><a href="/methods/" data-astro-cid-sz7xmlte>All Methods Reference</a></li> <li data-astro-cid-sz7xmlte><a href="https://github.com/jsoma/natural-pdf/issues" data-astro-cid-sz7xmlte>Report an Issue</a></li> <li data-astro-cid-sz7xmlte><a href="/about/" data-astro-cid-sz7xmlte>About This Gallery</a></li> </ul> </div> <div class="footer-section" data-astro-cid-sz7xmlte> <h3 data-astro-cid-sz7xmlte>Contribute</h3> <ul data-astro-cid-sz7xmlte> <li data-astro-cid-sz7xmlte><a href="/submit/" data-astro-cid-sz7xmlte>Submit a PDF Example</a></li> <li data-astro-cid-sz7xmlte><a href="https://github.com/jsoma/badpdfs-analysis" data-astro-cid-sz7xmlte>Gallery Source Code</a></li> <li data-astro-cid-sz7xmlte><a href="https://github.com/jsoma/natural-pdf#contributing" data-astro-cid-sz7xmlte>Contributing Guide</a></li> </ul> </div> </div> <div class="footer-bottom" data-astro-cid-sz7xmlte> <p data-astro-cid-sz7xmlte>&copy; 2025 Bad PDFs. Built with <a href="https://astro.build" data-astro-cid-sz7xmlte>Astro</a> and powered by <a href="https://jsoma.github.io/natural-pdf/" data-astro-cid-sz7xmlte>natural-pdf</a>.</p> </div> </div> </footer>  <script>(function(){const BASE_URL = "/";

  import FlexSearch from 'flexsearch';
  
  let searchIndex = null;
  let methodIndex = null;
  let documents = {};
  let allMetadata = [];
  let methodUsageMap = {};
  
  // Load search index and metadata
  async function loadSearchIndex() {
    try {
      // Load search index
      const response = await fetch(`${BASE_URL}artifacts/search_index.compact.json`);
      const data = await response.json();
      
      // Store documents
      data.documents.forEach(doc => {
        documents[doc.id] = doc;
      });
      
      // Store method index
      methodIndex = data.methodIndex;
      
      // Load all metadata for method usage snippets
      const metadataResponse = await fetch(`${BASE_URL}artifacts/all_metadata.json`);
      allMetadata = await metadataResponse.json();
      
      // Build method usage map
      allMetadata.forEach(item => {
        if (item.method_usage) {
          item.method_usage.forEach(usage => {
            const method = usage.method;
            if (!methodUsageMap[method]) {
              methodUsageMap[method] = [];
            }
            methodUsageMap[method].push({
              example: item.id,
              title: item.title,
              slug: item.slug,
              usage: usage
            });
          });
        }
      });
      
      // Create FlexSearch index
      searchIndex = new FlexSearch.Document({
        document: {
          id: 'id',
          index: ['title', 'description', 'content', 'methods', 'tags'],
          store: ['id', 'slug', 'title', 'description', 'methods']
        },
        tokenize: 'forward',
        threshold: 0,
        resolution: 9,
        depth: 3
      });
      
      // Add documents to index
      data.documents.forEach(doc => {
        searchIndex.add(doc);
      });
      
    } catch (error) {
      console.error('Failed to load search index:', error);
    }
  }
  
  // Helper function to format method usage as code snippet
  function formatMethodUsage(usage) {
    const args = usage.args || [];
    const kwargs = usage.kwargs || {};
    
    // Format arguments
    const argStrings = [];
    args.forEach(arg => {
      if (Array.isArray(arg)) {
        argStrings.push(`[${arg.map(item => typeof item === 'string' ? `"${item}"` : item).join(', ')}]`);
      } else if (typeof arg === 'string' && arg !== '<Lambda>') {
        argStrings.push(`"${arg}"`);
      } else if (arg === '<Lambda>') {
        argStrings.push('lambda ...');
      } else {
        argStrings.push(String(arg));
      }
    });
    
    // Format keyword arguments
    const kwargStrings = [];
    for (const [key, value] of Object.entries(kwargs)) {
      if (typeof value === 'string') {
        kwargStrings.push(`${key}="${value}"`);
      } else if (typeof value === 'boolean') {
        kwargStrings.push(`${key}=${value ? 'True' : 'False'}`);
      } else {
        kwargStrings.push(`${key}=${value}`);
      }
    }
    
    // Combine all parameters
    const allParams = [...argStrings, ...kwargStrings];
    const paramString = allParams.length > 0 ? allParams.join(', ') : '';
    
    return `.${usage.method}(${paramString})`;
  }
  
  // Search function
  function performSearch(query) {
    if (!searchIndex || query.length < 2) {
      return { documents: [], methods: {} };
    }
    
    // Search documents
    const docResults = searchIndex.search(query, {
      limit: 20,
      enrich: true
    });
    
    // Flatten results (FlexSearch returns results grouped by field)
    const seenIds = new Set();
    const uniqueResults = [];
    
    docResults.forEach(fieldResult => {
      fieldResult.result.forEach(item => {
        if (!seenIds.has(item.id)) {
          seenIds.add(item.id);
          uniqueResults.push(item.doc);
        }
      });
    });
    
    // Search for exact method matches and group by method with snippets
    const methodGroups = {};
    const queryLower = query.toLowerCase();
    
    if (methodUsageMap) {
      for (const [method, usageExamples] of Object.entries(methodUsageMap)) {
        if (method.toLowerCase().includes(queryLower)) {
          if (!methodGroups[method]) {
            methodGroups[method] = {
              method,
              usageExamples: []
            };
          }
          
          // Add usage examples with snippets, but deduplicate by PDF
          const seenPdfs = new Set();
          usageExamples.forEach(example => {
            if (!seenPdfs.has(example.slug)) {
              seenPdfs.add(example.slug);
              const snippet = formatMethodUsage(example.usage);
              methodGroups[method].usageExamples.push({
                title: example.title,
                slug: example.slug,
                snippet: snippet
              });
            }
          });
        }
      }
    }
    
    return {
      documents: uniqueResults,
      methods: methodGroups
    };
  }
  
  // Render search results
  function renderResults(results, query) {
    const container = document.getElementById('search-results-container');
    
    const methodCount = Object.keys(results.methods).length;
    
    if (!results.documents.length && methodCount === 0) {
      container.innerHTML = `
        <div class="empty-state">
          <p>No results found for "${escapeHtml(query)}"</p>
          <p class="help-text">Try searching for methods like "extract_text" or PDF titles</p>
        </div>
      `;
      return;
    }
    
    let html = '';
    
    // Method matches section - grouped by method
    if (methodCount > 0) {
      html += '<div class="results-section">';
      html += `<h2 class="results-header">Methods <span class="count">(${methodCount})</span></h2>`;
      html += '<div class="method-results">';
      
      // Sort methods by relevance
      const sortedMethods = Object.values(results.methods)
        .sort((a, b) => {
          // Prioritize exact matches
          const aExact = a.method.toLowerCase() === query.toLowerCase();
          const bExact = b.method.toLowerCase() === query.toLowerCase();
          if (aExact && !bExact) return -1;
          if (!aExact && bExact) return 1;
          
          // Then by number of usage examples
          return b.usageExamples.length - a.usageExamples.length;
        });
      
      sortedMethods.forEach(({ method, usageExamples }) => {
        const encodedMethod = encodeURIComponent(method.toLowerCase());
        const methodId = `method-${method.replace(/[^a-zA-Z0-9]/g, '-')}`;
        const initialSnippets = 3;
        
        html += `
          <a href="${BASE_URL}methods/${encodedMethod}" class="method-group">
            <div class="method-header">
              <h3 class="method-name">${escapeHtml(method)}</h3>
              <span class="method-count">${usageExamples.length} usage${usageExamples.length !== 1 ? 's' : ''}</span>
            </div>
            <div class="method-examples">
              <span class="examples-label">Used in:</span>
              ${usageExamples.slice(0, 3).map((example, index) => 
                `<span class="example-name">${escapeHtml(example.title)}</span>` +
                (index < Math.min(3, usageExamples.length) - 1 ? '<span class="separator">, </span>' : '')
              ).join('')}
              ${usageExamples.length > 3 ? '<span class="more">...</span>' : ''}
            </div>
          </a>
        `;
      });
      html += '</div>';
      html += '</div>';
    }
    
    // Document matches section
    if (results.documents.length > 0) {
      html += '<div class="results-section">';
      html += `<h2 class="results-header">PDFs <span class="count">(${results.documents.length})</span></h2>`;
      html += '<div class="pdf-results">';
      results.documents.forEach(doc => {
        html += `
          <a href="${BASE_URL}pdfs/${doc.slug}" class="result-item">
            <div class="result-title">${highlightMatch(doc.title, query)}</div>
            <div class="result-description">${highlightMatch(doc.description, query)}</div>
            <div class="result-methods">
              ${doc.methods.slice(0, 3).map(m => 
                `<span class="method-tag">${escapeHtml(m)}</span>`
              ).join('')}
              ${doc.methods.length > 3 ? `<span class="more-methods">+${doc.methods.length - 3} more</span>` : ''}
            </div>
          </a>
        `;
      });
      html += '</div>';
      html += '</div>';
    }
    
    container.innerHTML = html;
  }
  
  // Highlight matching text
  function highlightMatch(text, query) {
    const escaped = escapeHtml(text);
    const regex = new RegExp(`(${escapeRegex(query)})`, 'gi');
    return escaped.replace(regex, '<mark>$1</mark>');
  }
  
  // Escape HTML
  function escapeHtml(text) {
    const div = document.createElement('div');
    div.textContent = text;
    return div.innerHTML;
  }
  
  // Escape regex special characters
  function escapeRegex(string) {
    return string.replace(/[.*+?^${}()|[\]\\]/g, '\\$&');
  }
  
  // Setup search
  async function setupSearch() {
    await loadSearchIndex();
    
    const urlParams = new URLSearchParams(window.location.search);
    const initialQuery = urlParams.get('q') || '';
    
    // Perform initial search if query exists
    if (initialQuery && searchIndex) {
      const results = performSearch(initialQuery);
      renderResults(results, initialQuery);
    }
  }
  
  // Initialize on load
  setupSearch();
})();</script> </body></html>